(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f210013"],{"0967":function(e,t,a){"use strict";a("becb")},4473:function(e,t,a){},"4ec25":function(e,t,a){"use strict";a("6a61");var r=a("2e91"),o=a("d211"),n=a("5880"),i=a("b8f9"),s={data:function(){return{id:null,isReadonly:!1,formData:{branchId:this.$UserInfo.bid,state:!0,weight:1}}},props:{formData_bak:{type:Object,default:function(){return{}}},formModel:{type:Object,default:function(){return{}}},btnTitle:{type:String,default:""},tabName:{type:Array,default:function(){return[null]}}},created:function(){this.id=this.$GetParamsId(this),this.$FormCheck("*",this.formModel.readonly)&&(this.isReadonly=!0,this.ruleInline={})},computed:Object(o["a"])({},Object(n["mapState"])("base",{loading:function(e){return e.loading},isMethodList:function(e){return e.isMethodList}})),methods:{handleEmitData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData;this.$store.commit("popupModel/pageModal",{pageModal:!1}),this.$emit("formDataSubmit",{data:e})},handleFilterBranchChange:function(e){i["a"].isEmpty(e)||(this.formData.branchId=e)},handleSumbit:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,n,s,l,c,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:t.formData,n=e.length>1&&void 0!==e[1]?e[1]:"form",o.state=!0===o.state||1*o.state===1?1:2,s=!0,l=!1,!i["a"].isString(n)){a.next=16;break}if(t.$refs[n]){a.next=11;break}s=!1,l=!0,a.next=14;break;case 11:return a.next=13,t.$refs[n].validate((function(e){return e}));case 13:l=a.sent;case 14:a.next=22;break;case 16:if(!i["a"].isArray(n)){a.next=22;break}return c=!0,i["a"].each(n,function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs[a]?t.$refs[a].validate((function(e){!1===e&&!0===c&&(c=!1)})):(s=!1,c=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.next=21,c;case 21:l=a.sent;case 22:if(!1!==s||!0!==l){a.next=25;break}return t.handleEmitData(o),a.abrupt("return");case 25:if(!1!==l){a.next=28;break}return t.$Message.error(t.$t("dt.form.checkFormComplete")),a.abrupt("return");case 28:d=t.$store.state.popupModel.pageModal,!0===d&&t.$store.commit("popupModel/loadData",{loadData:!0}),t.handleEmitData(o);case 31:case"end":return a.stop()}}),a)})))()}}};t["a"]=s},"5a49":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"edit-wrap"},[a("div",{ref:"edit"}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowCode,expression:"isShowCode"}],staticClass:"code"},[a("div",{staticClass:"w-e-toolbar"},[a("div",{staticClass:"w-e-menu",staticStyle:{"font-size":"12px"},on:{click:function(t){return e.handleEditCode(!1)}}},[e._v(" "+e._s(e.$t("dt.base.outEditCode"))+" ")])]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"menu"},[a("div",{ref:"menu-code",staticClass:"w-e-menu",staticStyle:{"z-index":"10001","font-size":"12px"}},[a("div",{on:{click:function(t){return e.handleEditCode(!0)}}},[e._v(e._s(e.$t("dt.base.editCode")))])])])])},o=[],n=(a("2d38"),a("1b8a"),a("69bf"),a("02bf"),a("233a"),a("5c4c"),a("845c"),a("d8f4"),a("9151"),a("2083"),a("066a"),a("6a61"),a("2e91")),i=a("b8f9"),s=a("e01c"),l=a("0358"),c=a.n(l),d=a("c798"),m=a.n(d),u={name:"edit",props:{value:null,format:{type:Array,default:function(){return["jpg","jpeg","png"]}},disabled:{type:Boolean,default:!1}},data:function(){return{timer:null,code:"",editor:null,isShowCode:!1,uploadFile:[]}},watch:{value:function(){var e=this;this.timer?clearTimeout(this.timer):(this.timer=setTimeout((function(){e.editor.txt.html(e.value)}),50),this.$Bus.$emit("timer",this.timer))}},created:function(){},mounted:function(){var e=this,t=new m.a(this.$refs.edit);t.config.onchange=function(t){e.code=t},t.config.customUploadImg=function(t,a){i["a"].each(t,(function(t){e.handleFileHash(t,a)}))},t.create(),this.editor=t,this.disabled&&this.editor.disable()},beforeDestroy:function(){this.editor.destroy(),this.editor=null},methods:{handleEditCode:function(e){this.isShowCode=e,e?this.code=this.editor.txt.html():this.editor.txt.html(this.code)},handleFileHash:function(e,t){var a=this,r=e.name.split("."),o=r[r.length-1];if(this.format.indexOf(o)<=-1)this.$Notice.warning({title:this.$t("dt.toast.IncorrectFileFormat"),desc:this.$t("dt.toast.UploadFileFormat",{label:e.name,format:this.format})});else if(e.size>this.maxSize)this.$Notice.warning({title:this.$t("dt.toast.FileSizeLimitExceeded"),desc:"".concat(e.name).concat(this.$t("dt.toast.UploadFileMaxSize"))});else{var s=new FileReader,l=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice,d=2097152,m=Math.ceil(e.size/d),u=new c.a,h=0;s.onload=function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:u.appendBinary(r.target.result),h++,h<m?f():a.uploadFile.push({hash:u.end(),file:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f(),s.onloadend=Object(n["a"])(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i["a"].isEmpty(a.uploadFile)){e.next=5;break}return e.next=3,a.handleUpload();case 3:r=e.sent,i["a"].isEmpty(r)||(o=r[r.length-1],t(a.$options.filters.formatImage(o.path,1)));case 5:case"end":return e.stop()}}),e)})))}function f(){var t=h*d,a=t+d>=e.size?e.size:t+d;s.readAsBinaryString(l.call(e,t,a))}},handleUpload:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r,o,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!i["a"].isEmpty(e.uploadFile)){t.next=3;break}return e.$Notice.error({title:e.$t("dt.toast.UploadFileIsEmpty")}),t.abrupt("return");case 3:if(!(e.uploadFile.length>5)){t.next=6;break}return e.$Notice.error({title:e.$t("dt.toast.UploadMultipleMax")}),t.abrupt("return");case 6:return a=[],i["a"].each(e.uploadFile,(function(e){a.push(e.hash)})),t.next=10,e.$Http.Post({mutation:e.$Model.CheckUpload,variables:{hash:a}}).then((function(e){return e}));case 10:if(r=t.sent,o=r.data,n=[],i["a"].each(o.data,(function(t){if(!1===t.status){var a=e.uploadFile.find((function(e){return e.hash===t.hash}));i["a"].isEmpty(a)||n.push(a)}})),s=null,i["a"].isEmpty(n)){t.next=21;break}return t.next=18,e.handleSumbitUpload(n);case 18:s=t.sent,t.next=24;break;case 21:return t.next=23,e.handleEmitValue(o.data);case 23:s=t.sent;case 24:return t.abrupt("return",s);case 25:case"end":return t.stop()}}),t)})))()},handleSumbitUpload:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,o,l,c,d,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!i["a"].isEmpty(e)){a.next=3;break}return t.$Notice.error({title:t.$t("dt.toast.UploadFileIsEmpty")}),a.abrupt("return");case 3:if(!(e.length>5)){a.next=6;break}return t.$Notice.error({title:t.$t("dt.toast.UploadMultipleMax")}),a.abrupt("return");case 6:return r=t.$options.filters.formatTime(t.$UserInfo.hash,"YYYYMMDD_hhmmss"),o=t.$options.filters.formatTime(new Date,"YYYY-MM-DD"),l=[],a.next=11,Promise.all(e.map(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].client.put("".concat(r,"/").concat(o,"/").concat(t.hash),t.file);case 2:return a=e.sent,l.push({hash:t.hash,path:a.name}),e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:if(c=null,i["a"].isEmpty(l)){a.next=20;break}return a.next=15,t.$Http.Post({mutation:t.$Model.Upload,variables:{file:l}}).then((function(e){return e}));case 15:return d=a.sent,m=d.data,a.next=19,t.handleEmitValue(m);case 19:c=a.sent;case 20:return a.abrupt("return",c);case 21:case"end":return a.stop()}}),a)})))()},handleEmitValue:function(e){return this.uploadFile=[],e}}},h=u,f=(a("9d2e"),a("c701")),p=Object(f["a"])(h,r,o,!1,null,"206a2ac5",null);t["a"]=p.exports},"9c05":function(e,t,a){"use strict";var r=a("47c2"),o=a("d376"),n=a("d49d"),i=a("3f5a"),s=a("38f9"),l=a("936a");r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=n(this),a=i(t.length),r=l(t,0);return r.length=o(r,t,t,a,0,void 0===e?1:s(e)),r}})},"9d2e":function(e,t,a){"use strict";a("4473")},becb:function(e,t,a){},c627:function(e,t,a){var r=a("3592");r("flat")},d376:function(e,t,a){"use strict";var r=a("6db8"),o=a("3f5a"),n=a("7144"),i=function(e,t,a,s,l,c,d,m){var u,h=l,f=0,p=!!d&&n(d,m,3);while(f<s){if(f in a){if(u=p?p(a[f],f,t):a[f],c>0&&r(u))h=i(e,t,u,o(u.length),h,c-1)-1;else{if(h>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[h]=u}h++}f++}return h};e.exports=i},e26f:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content-layer"},[a("Tabs",{staticClass:"tabs",attrs:{type:"card"}},[a("TabPane",{attrs:{label:e.tabName[0]}},[a("Form",{ref:"form",staticClass:"form-page",attrs:{"label-position":"right","label-width":100,model:e.formData,rules:e.ruleInline}},[a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("name",e.formModel.hide),expression:"!$FormCheck('name', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.SystemName"),prop:"name"}},[a("Input",{attrs:{readonly:e.$FormCheck("name",e.formModel.readonly),disabled:e.$FormCheck("name",e.formModel.readonly),clearable:!e.$FormCheck("name",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.SystemName")})},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("toType",e.formModel.hide),expression:"!$FormCheck('toType', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.base.SendTheObject"),prop:"toType"}},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.handleToObjectChange},model:{value:e.formData.toType,callback:function(t){e.$set(e.formData,"toType",t)},expression:"formData.toType"}},e._l(e.$options.filters.systemToType([]),(function(t){return a("Radio",{key:t.value,attrs:{clearable:!e.$FormCheck("toType",e.formModel.readonly),disabled:e.$FormCheck("toType",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:2===e.formData.toType,expression:"formData.toType === 2"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{prop:"ids"}},[a("Select",{attrs:{multiple:"",disabled:e.$FormCheck("ids",e.formModel.readonly),readonly:e.$FormCheck("ids",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.MerchantType")})},model:{value:e.formData.ids,callback:function(t){e.$set(e.formData,"ids",t)},expression:"formData.ids"}},e._l(e.formTemp.merchantType,(function(t,r){return a("Option",{key:r,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:3===e.formData.toType,expression:"formData.toType === 3"}],staticClass:"input-item",attrs:{xs:24,sm:22,md:22,lg:20,xl:18,xxl:16}},[a("FormItem",{attrs:{prop:"ids"}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Merchant")}),route:"MerchantAdd",api:e.$Model.CommonMerchants,column:[{name:e.$t("dt.form.MerchantName")},{remark:e.$t("dt.base.remark")}],attrs:{label:"name",value:"id"},placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.MerchantName")})},model:{value:e.formData.toUser,callback:function(t){e.$set(e.formData,"toUser",t)},expression:"formData.toUser"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("tye",e.formModel.hide),expression:"!$FormCheck('tye', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.SystemType"),prop:"tye"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formData.tye,callback:function(t){e.$set(e.formData,"tye",t)},expression:"formData.tye"}},e._l(e.$options.filters.noticeType([]),(function(t,r){return a("Radio",{key:r,attrs:{clearable:!e.$FormCheck("tye",e.formModel.readonly),disabled:e.$FormCheck("tye",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("color",e.formModel.hide),expression:"!$FormCheck('color', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.base.TitleColor"),prop:"color"}},[a("ColorPicker",{attrs:{disabled:e.$FormCheck("color",e.formModel.readonly)},model:{value:e.formData.color,callback:function(t){e.$set(e.formData,"color",t)},expression:"formData.color"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("content",e.formModel.hide),expression:"!$FormCheck('content', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:24,md:24,lg:24,xl:20,xxl:12}},[a("FormItem",{attrs:{label:e.$t("dt.base.Content"),prop:"content"}},[a("Edit",{model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("weight",e.formModel.hide),expression:"!$FormCheck('weight', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.weight"),prop:"weight"}},[a("Input",{attrs:{readonly:e.$FormCheck("weight",e.formModel.readonly),clearable:!e.$FormCheck("weight",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.weight")})},model:{value:e.formData.weight,callback:function(t){e.$set(e.formData,"weight",e._n(t))},expression:"formData.weight"}})],1)],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.status")}},[a("i-switch",{attrs:{disabled:e.$FormCheck("state",e.formModel.readonly),size:"large"},model:{value:e.formData.state,callback:function(t){e.$set(e.formData,"state",t)},expression:"formData.state"}},e._l(e.$options.filters.state([]),(function(t,r){return a("span",{key:r,attrs:{slot:1===1*t.value?"open":"close"},slot:1===1*t.value?"open":"close"},[e._v(e._s(t.label))])})),0)],1)],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",[!e.isReadonly&&e.$isHasMenuAuth("admin.SystemAdd")||!e.isReadonly&&e.$isHasMenuAuth("admin.SystemEdit")?a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSumbitCheck}},[e._v(" "+e._s(e.btnTitle)+" ")]):e.$isHasMenuAuth("admin.SystemEdit")?a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleCheckHabitType({name:"admin.SystemEdit",params:{id:e.id}})}}},[e._v(" "+e._s(e.$t("dt.form.edit"))+" ")]):e._e(),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleRouteGoBack("admin.SystemList")}}},[e._v(e._s(e.$t("dt.base.back")))])],1)],1)],1)],1)],1)],1)},o=[],n=(a("2d38"),a("9c05"),a("64fe"),a("02bf"),a("c627"),a("d8f4"),a("2083"),a("d211")),i=a("b8f9"),s=a("4ec25"),l=a("5a49"),c=a("494e"),d={name:"SystemModel",mixins:[s["a"]],data:function(){return{formTemp:{merchantType:[]},formData:{toUser:[],ids:[],color:"#2D8cF0"},ruleInline:{name:[{required:!0,message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.form.SystemName")}),trigger:"blur"}],toType:[{required:!0,type:"number",message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.base.SendTheObject")}),trigger:"blur"}],tye:[{required:!0,type:"number",message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.SystemType")}),trigger:"blur"}],weight:[{required:!0,type:"number",message:this.$t("dt.form.weightPlaceholder"),trigger:"blur"},{validator:this.$Validator("number",this.$t("dt.form.weightPlaceholder")),trigger:"blur"}]}}},created:function(){this.handleMerchantTypeList(),i["a"].isEmpty(this.id)||this.handleDetail()},mounted:function(){},components:{Edit:l["a"],ListSelectModal:c["a"]},watch:{},methods:{handleDetail:function(){var e=this;this.$Http.Post({mutation:this.$Model.MerchantNoticeDetail,variables:{id:this.id},fields:["id","name","content","color","ids","toType","tye","weight","state"]},(function(){e.$router.push({name:"admin.SystemList"})})).then((function(t){var a=t.data;a.state=1===a.state||!0===a.state,a.ids=i["a"].isString(a.ids)?a.ids.split(","):[],e.formData=Object(n["a"])(Object(n["a"])({},e.formData),a)}))},handleMerchantTypeList:function(){var e=this;this.$isHasMenuAuth("admin.MerchantTypeList")&&this.$Http.Post({mutation:this.$Model.MerchantTypes,variables:{perPage:0},fields:[{data:["id","name","merchantsIds"]}]}).then((function(t){var a=t.data;e.formTemp.merchantType=a.data}))},handleToObjectChange:function(e){var t=this;2!==e&&(this.formData.ids=[]),1===e?this.formData.toUser=this.formTemp.merchantType.map((function(e){return e.merchantsIds})).flat():2===e?i["a"].each(this.formTemp.merchantType,(function(e){t.formData.toUser=t.formData.toUser.concat(e.merchantsIds.flat())})):this.formData.toUser=[],this.formData.toUser=i["a"].uniqBy(this.formData.toUser)},handleSumbitCheck:function(){1!==this.formData.toType?this.ruleInline.ids=[{required:!0,type:"array",message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.MerchantType")}),trigger:"blur"}]:delete this.ruleInline.ids;var e=Object(n["a"])({},this.formData);e.user=[],e.ids=e.ids&&i["a"].isArray(e.ids)?e.ids.join():"",i["a"].each(e.toUser,(function(t){e.user.push({mid:t})})),delete e.toUser,this.handleSumbit(e)}}},m=d,u=(a("0967"),a("c701")),h=Object(u["a"])(m,r,o,!1,null,"04d3cbb0",null);t["a"]=h.exports}}]);