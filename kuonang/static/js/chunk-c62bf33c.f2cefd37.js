(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c62bf33c"],{"2f13":function(e,t,a){},"4ec25":function(e,t,a){"use strict";a("6a61");var r=a("2e91"),o=a("d211"),l=a("5880"),i=a("b8f9"),n={data:function(){return{id:null,isReadonly:!1,formData:{branchId:this.$UserInfo.bid,state:!0,weight:1}}},props:{formData_bak:{type:Object,default:function(){return{}}},formModel:{type:Object,default:function(){return{}}},btnTitle:{type:String,default:""},tabName:{type:Array,default:function(){return[null]}}},created:function(){this.id=this.$GetParamsId(this),this.$FormCheck("*",this.formModel.readonly)&&(this.isReadonly=!0,this.ruleInline={})},computed:Object(o["a"])({},Object(l["mapState"])("base",{loading:function(e){return e.loading},isMethodList:function(e){return e.isMethodList}})),methods:{handleEmitData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData;this.$store.commit("popupModel/pageModal",{pageModal:!1}),this.$emit("formDataSubmit",{data:e})},handleFilterBranchChange:function(e){i["a"].isEmpty(e)||(this.formData.branchId=e)},handleSumbit:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,l,n,s,d,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:t.formData,l=e.length>1&&void 0!==e[1]?e[1]:"form",o.state=!0===o.state||1*o.state===1?1:2,n=!0,s=!1,!i["a"].isString(l)){a.next=16;break}if(t.$refs[l]){a.next=11;break}n=!1,s=!0,a.next=14;break;case 11:return a.next=13,t.$refs[l].validate((function(e){return e}));case 13:s=a.sent;case 14:a.next=22;break;case 16:if(!i["a"].isArray(l)){a.next=22;break}return d=!0,i["a"].each(l,function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs[a]?t.$refs[a].validate((function(e){!1===e&&!0===d&&(d=!1)})):(n=!1,d=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.next=21,d;case 21:s=a.sent;case 22:if(!1!==n||!0!==s){a.next=25;break}return t.handleEmitData(o),a.abrupt("return");case 25:if(!1!==s){a.next=28;break}return t.$Message.error(t.$t("dt.form.checkFormComplete")),a.abrupt("return");case 28:m=t.$store.state.popupModel.pageModal,!0===m&&t.$store.commit("popupModel/loadData",{loadData:!0}),t.handleEmitData(o);case 31:case"end":return a.stop()}}),a)})))()}}};t["a"]=n},8048:function(e,t,a){"use strict";a("2f13")},"8caa":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content-layer"},[a("Tabs",{staticClass:"tabs",attrs:{type:"card"}},[a("TabPane",{attrs:{label:e.tabName[0]}},[a("Form",{ref:"form",staticClass:"form-page",attrs:{"label-position":"right","label-width":100,model:e.formData,rules:e.ruleInline}},[a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("name",e.formModel.hide),expression:"!$FormCheck('name', formModel.hide)"}],staticClass:"input-item form-item-flex",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.ProgramName"),prop:"name"}},[a("Input",{attrs:{readonly:e.$FormCheck("name",e.formModel.readonly),clearable:!e.$FormCheck("name",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.ProgramName")})},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("target",e.formModel.hide),expression:"!$FormCheck('target', formModel.hide)"}],staticClass:"input-item form-item-flex",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.ProgramTarget"),prop:"target"}},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.handleTargetChange},model:{value:e.formData.target,callback:function(t){e.$set(e.formData,"target",t)},expression:"formData.target"}},e._l(e.$options.filters.programTarget([]),(function(t){return a("Radio",{key:t.value,attrs:{clearable:!e.$FormCheck("target",e.formModel.readonly),disabled:e.$FormCheck("target",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("rolesIds",e.formModel.hide)&&2===e.formData.target,expression:"!$FormCheck('rolesIds', formModel.hide) && formData.target === 2"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.RelationAuth"),prop:"rolesIds"}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.RelationAuth")}),route:"RoleAdd",api:e.$Model.Roles,column:[{name:e.$t("dt.form.role")}],attrs:{label:"name",value:"id"},readonly:e.$FormCheck("rolesIds",e.formModel.readonly),clearable:!e.$FormCheck("rolesIds",e.formModel.readonly),callback:e.handleRoleDataFunc,placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.role")})},model:{value:e.formData.rolesIds,callback:function(t){e.$set(e.formData,"rolesIds",t)},expression:"formData.rolesIds"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("inJobTime",e.formModel.hide),expression:"!$FormCheck('inJobTime', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{staticClass:"auto-width",attrs:{label:""+e.$t("dt.base.Entry")+e.$t("dt.base.Full"),prop:"inJobTime"}},[a("InputNumber",{attrs:{min:0,readonly:e.$FormCheck("inJobTime",e.formModel.readonly),clearable:!e.$FormCheck("inJobTime",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseInput",{label:""+e.$t("dt.base.Entry")+e.$t("dt.base.Full")+e.$t("dt.base.Day")})},model:{value:e.formData.inJobTime,callback:function(t){e.$set(e.formData,"inJobTime",t)},expression:"formData.inJobTime"}}),a("span",[e._v(" "+e._s(e.$t("dt.base.Day")))])],1)],1),a("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:24,lg:24,xl:16,xxl:12}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("other",e.formModel.hide),expression:"!$FormCheck('other', formModel.hide)"}],attrs:{prop:"other"}},[a("Tooltip",{attrs:{slot:"label",transfer:!0,"max-width":200,content:e.$t("dt.toast.OtherDividendToast"),placement:"top"},slot:"label"},[a("span",[e._v(e._s(e.$t("dt.form.OtherTarget")))]),a("Icon",{attrs:{size:16,color:"#f90",type:"ios-alert-outline"}})],1),a("div",{staticClass:"product-layer"},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.handleOtherChange},model:{value:e.formData.other,callback:function(t){e.$set(e.formData,"other",t)},expression:"formData.other"}},e._l(e.$options.filters.otherUser([]),(function(t){return a("Radio",{key:t.value,attrs:{clearable:!e.$FormCheck("other",e.formModel.readonly),disabled:e.$FormCheck("other",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1),a("ListSelectModal",{directives:[{name:"show",rawName:"v-show",value:2===e.formData.other,expression:"formData.other === 2"}],ref:"user",staticStyle:{"margin-top":"10px"},attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.base.Salesman")}),route:"UserAdd",api:e.$Model.Users,column:[{username:e.$t("dt.form.UserName")},{phone:e.$t("dt.form.Phone")},{groups:{name:e.$t("dt.form.group")}},{roles:{name:e.$t("dt.form.role")}},{other:e.$t("dt.form.OtherDividend"),filters:"otherStatus"}],attrs:{label:"username",value:"id"},filter:{other_ne:0},readonly:e.$FormCheck("otherTargetIds",e.formModel.readonly),clearable:!e.$FormCheck("otherTargetIds",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.UserName")})},model:{value:e.formData.otherTargetIds,callback:function(t){e.$set(e.formData,"otherTargetIds",t)},expression:"formData.otherTargetIds"}},[e.$isHasMenuAuth("admin.GroupList")?a("div",{staticClass:"filter-item",attrs:{slot:"filter"},slot:"filter"},[a("span",[e._v(e._s(e.$t("dt.form.parentGroup"))+"：")]),a("Select",{attrs:{clearable:"",placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.group")})},on:{"on-change":e.handleFilterUserChange}},e._l(e.formTemp.groupList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e()])],1)],1)],1),a("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:24,lg:24,xl:16,xxl:12}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("isAll",e.formModel.hide),expression:"!$FormCheck('isAll', formModel.hide)"}],attrs:{label:e.$t("dt.form.RelationProduct"),prop:"isAll"}},[a("div",{staticClass:"product-layer"},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.handleisAllChange},model:{value:e.formData.isAll,callback:function(t){e.$set(e.formData,"isAll",t)},expression:"formData.isAll"}},e._l(e.$options.filters.relationProduct([]),(function(t){return a("Radio",{key:t.value,attrs:{clearable:!e.$FormCheck("isAll",e.formModel.readonly),disabled:e.$FormCheck("isAll",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1),a("ListSelectModal",{directives:[{name:"show",rawName:"v-show",value:2===e.formData.isAll,expression:"formData.isAll === 2"}],ref:"product",staticStyle:{"margin-top":"10px"},attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.RelationProduct")}),route:"ProductAdd",readonly:e.$FormCheck("productIds",e.formModel.readonly),api:e.$Model.Products,column:[{name:e.$t("dt.form.Product")},{productBarCode:e.$t("dt.form.BarCode")},{productCode:e.$t("dt.form.ProductCode")}],attrs:{label:"name",value:"id"},placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Product")})},model:{value:e.formData.productIds,callback:function(t){e.$set(e.formData,"productIds",t)},expression:"formData.productIds"}},[a("div",{staticClass:"tree-layer",attrs:{slot:"left"},slot:"left"},[a("span",[e._v(e._s(e.$t("dt.form.ProductCategory")))]),a("Tree",{attrs:{data:e.formTemp.categoryList},on:{"on-select-change":e.handleTreeSelectChange}})],1)])],1)])],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("tye",e.formModel.hide),expression:"!$FormCheck('tye', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.ProgramType"),prop:"tye"}},[a("RadioGroup",{attrs:{type:"button"},model:{value:e.formData.tye,callback:function(t){e.$set(e.formData,"tye",t)},expression:"formData.tye"}},e._l(e.$options.filters.programType([]),(function(t){return a("Radio",{key:t.value,attrs:{clearable:!e.$FormCheck("tye",e.formModel.readonly),disabled:e.$FormCheck("tye",e.formModel.readonly),label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),e.formData.tye?a("Col",{staticClass:"input-item",attrs:{xs:24,sm:24,md:24,lg:24,xl:16,xxl:14}},[a("FormItem",[a("Table",{attrs:{columns:e.columns,data:e.formData.child,draggable:!0},on:{"on-drag-drop":e.handleTableOnDragDrop},scopedSlots:e._u([{key:"label",fn:function(t){var r=t.row,o=t.index,l=t.column;return[r.roleRatio.length>0?a("Poptip",{attrs:{transfer:"",trigger:"hover",width:"520"}},[a("div",{staticClass:"ivu-table-cell-tree",staticStyle:{"margin-right":"5px"}},[a("Icon",{attrs:{type:"ios-add"}})],1),a("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[a("table",[a("thead",[a("tr",[a("th",[e._v(e._s(e.$t("dt.form.role")))]),a("th",[e._v(e._s(e.$t("dt.form.DividendRatio")))]),a("th",[e._v(e._s(e.$t("dt.form.Surplus")))]),a("th",[e._v(e._s(e.$t("dt.base.explain")))])])]),a("tbody",e._l(r.roleRatio,(function(t,o){return a("tr",{key:t.id},[a("td",[e._v(e._s(t.name))]),a("td",[a("InputNumber",{attrs:{size:"small",min:.01,max:100-r.roleRatio.filter((function(e,t){return t!==o})).map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0),step:.01,readonly:e.$FormCheck(t.ratio,e.formModel.readonly),clearable:!e.$FormCheck(t.ratio,e.formModel.readonly)},model:{value:t.ratio,callback:function(a){e.$set(t,"ratio",a)},expression:"item.ratio"}}),e._v(" % ")],1),0===o?a("td",{attrs:{rowspan:r.roleRatio.length}},[e._v(" "+e._s(e._f("toFixed")(100-r.roleRatio.map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0)))+" % ")]):e._e(),a("td",[e._v(e._s("例：提成额 = "+r.label+" * ("+ +t.ratio+" / 100)"))])])})),0)])])]):e._e(),a("InputNumber",{attrs:{size:"small",min:1,readonly:e.$FormCheck(l.slot,e.formModel.readonly),clearable:!e.$FormCheck(l.slot,e.formModel.readonly)},on:{"on-change":function(t){return e.handleValueChange(r,o,l.slot)}},model:{value:r.label,callback:function(t){e.$set(r,"label",t)},expression:"row.label"}}),1===e.formData.tye?a("span",[e._v(" "+e._s(e.$t("dt.base.unit")))]):a("span",[e._v(" "+e._s(e.$t("dt.base.piece")))]),a("span",[e._v(e._s(e.$t("dt.base.above")))])]}},{key:"value",fn:function(t){var r=t.row,o=t.index,l=t.column;return[void 0!==e.id?a("Tooltip",{attrs:{slot:"label",transfer:!0,"max-width":200,content:e.$t("dt.toast.DividendMoneyEditToast"),placement:"top"},slot:"label"},[a("InputNumber",{attrs:{size:"small",min:.01,max:1===r.tye?100:1/0,step:.01,readonly:e.$FormCheck(l.slot,e.formModel.readonly),clearable:!e.$FormCheck(l.slot,e.formModel.readonly)},on:{"on-change":function(t){return e.handleValueChange(r,o,l.slot)}},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}})],1):a("InputNumber",{attrs:{size:"small",min:.01,max:1===r.tye?100:1/0,step:.01,readonly:e.$FormCheck(l.slot,e.formModel.readonly),clearable:!e.$FormCheck(l.slot,e.formModel.readonly)},on:{"on-change":function(t){return e.handleValueChange(r,o,l.slot)}},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}}),1===r.tye?a("span",[e._v(" %")]):a("span",[e._v(" "+e._s(e.$t("dt.base.unit")))])]}},{key:"tye",fn:function(t){var r=t.row,o=t.index,l=t.column;return[a("Poptip",{attrs:{transfer:"",trigger:"hover",width:"520"}},[a("RadioGroup",{attrs:{size:"small",type:"button"},on:{"on-change":function(t){return e.handleTyeValueChange(r,o,l.slot)}},model:{value:r.tye,callback:function(t){e.$set(r,"tye",t)},expression:"row.tye"}},e._l(e.$options.filters.dividendRatio([]),(function(t,r){return a("Radio",{key:r,attrs:{readonly:e.$FormCheck(l.slot,e.formModel.readonly)||e.isReadonly,clearable:!e.$FormCheck(l.slot,e.formModel.readonly)||!e.isReadonly,label:t.value}},[e._v(e._s(t.label)+" ")])})),1),a("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[a("table",[a("thead",[a("tr",[a("th",[e._v(e._s(e.$t("dt.form.role")))]),a("th",[e._v(e._s(e.$t("dt.form.DividendRatio")))]),a("th",[e._v(e._s(e.$t("dt.form.Surplus")))]),a("th",[e._v(e._s(e.$t("dt.base.explain")))])])]),a("tbody",[r.roleRatio.length<=0?a("tr",[a("td",{attrs:{colspan:"4"}},[e._v(e._s(e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.RelationAuth")})))])]):e._e(),e._l(r.roleRatio,(function(t,l){return a("tr",{key:t.id},[a("td",[e._v(e._s(t.name))]),a("td",[a("InputNumber",{attrs:{size:"small",min:.01,max:100-r.roleRatio.filter((function(e,t){return t!==l})).map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0),step:.01,readonly:e.$FormCheck(t.ratio,e.formModel.readonly),clearable:!e.$FormCheck(t.ratio,e.formModel.readonly)},on:{"on-change":function(a){return e.handleRoleRatioChange(t.ratio,o,l)}},model:{value:t.ratio,callback:function(a){e.$set(t,"ratio",a)},expression:"item.ratio"}}),e._v(" % ")],1),0===l?a("td",{attrs:{rowspan:r.roleRatio.length}},[e._v(" "+e._s(e._f("toFixed")(100-r.roleRatio.map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0)))+" % ")]):e._e(),a("td",[e._v(e._s("例：提成额 = "+r.label+" * ("+ +t.ratio+" / 100)"))])])}))],2)])])],1)]}},{key:"action",fn:function(t){var r=t.index;return[e.formData.child.length>1?a("Button",{staticStyle:{"margin-right":"5px"},attrs:{size:"small",type:"error",disabled:e.isReadonly},on:{click:function(t){return e.handleAttrValueRemove(r)}}},[e._v(" "+e._s(e.$t("dt.form.delete"))+" ")]):e._e(),e.formData.child.length-1===r?a("Button",{attrs:{size:"small",type:"primary",disabled:e.isReadonly},on:{click:function(t){return e.handleAttrValueAdd()}}},[e._v(" "+e._s(e.$t("dt.form.add"))+" ")]):e._e()]}}],null,!1,4004110852)})],1)],1):e._e(),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("remark",e.formModel.hide),expression:"!$FormCheck('remark', formModel.hide)"}],staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:24,lg:24,xl:16,xxl:12}},[a("FormItem",{attrs:{label:e.$t("dt.base.remark"),prop:"remark"}},[a("Input",{attrs:{readonly:e.$FormCheck("remark",e.formModel.readonly),clearable:!e.$FormCheck("remark",e.formModel.readonly),maxlength:"255","show-word-limit":"",type:"textarea",rows:4,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.remark")})},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.status")}},[a("i-switch",{attrs:{disabled:e.$FormCheck("state",e.formModel.readonly),size:"large"},model:{value:e.formData.state,callback:function(t){e.$set(e.formData,"state",t)},expression:"formData.state"}},e._l(e.$options.filters.state([]),(function(t,r){return a("span",{key:r,attrs:{slot:1===1*t.value?"open":"close"},slot:1===1*t.value?"open":"close"},[e._v(e._s(t.label))])})),0)],1)],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",[!e.isReadonly&&e.$isHasMenuAuth("admin.ProgramAdd")||!e.isReadonly&&e.$isHasMenuAuth("admin.ProgramEdit")?a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSumbitCheck}},[e._v(" "+e._s(e.btnTitle)+" ")]):e.$isHasMenuAuth("admin.ProgramEdit")?a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleCheckHabitType({name:"admin.ProgramEdit",params:{id:e.id}})}}},[e._v(" "+e._s(e.$t("dt.form.edit"))+" ")]):e._e(),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleRouteGoBack("admin.ProgramList")}}},[e._v(e._s(e.$t("dt.base.back")))])],1)],1)],1)],1)],1)],1)},o=[],l=(a("2d38"),a("2c78"),a("422c"),a("02bf"),a("90d4"),a("5c4c"),a("4037"),a("1f90"),a("4c09")),i=a("d211"),n=a("b8f9"),s=a("4ec25"),d=a("494e"),m={name:"ProgramModel",mixins:[s["a"]],data:function(){return{formTemp:{categoryList:[],programType:[],payType:[],groupList:[],roles:[]},formData:{rolesIds:[],productIds:[],isAll:1,target:2,tye:1,inJobTime:0,other:1,otherTargetIds:[],child:[{label:1,value:0,tye:1,roleRatio:[]}]},ruleInline:{name:[{required:!0,message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.form.ProgramName")}),trigger:"blur"}],target:[{required:!0,type:"number",message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.form.ProgramTarget")}),trigger:"blur"}],tye:[{required:!0,type:"number",message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.ProgramType")}),trigger:"blur"}],weight:[{required:!0,type:"number",message:this.$t("dt.form.weightPlaceholder"),trigger:"blur"},{validator:this.$Validator("number",this.$t("dt.form.weightPlaceholder")),trigger:"blur"}]}}},computed:{columns:function(){return[{title:this.$options.filters.programType(this.formData.tye),align:"center",width:220,slot:"label"},{title:this.$t("dt.form.DividendMoney"),align:"center",slot:"value"},{title:this.$t("dt.base.ComputeType"),align:"center",width:160,slot:"tye"},{title:this.$t("dt.form.action"),width:130,slot:"action"}]}},created:function(){this.handleProductCategory(),this.handleGroupList(),n["a"].isEmpty(this.id)||this.handleDetail()},mounted:function(){window.aa=this},components:{ListSelectModal:d["a"]},watch:{},methods:{handleDetail:function(){var e=this;this.$Http.Post({mutation:this.$Model.DividendDetail,variables:{id:this.id},fields:["id","name","target","isAll","tye","remark","weight","state","other","otherTargetIds","child.id","child.label","child.value","child.tye","child.weight","child.roleRatio.id","child.roleRatio.ratio","child.roleRatio.roleId","child.roleRatio.role.id","child.roleRatio.role.name","rolesIds","productIds"]},(function(){e.$router.push({name:"admin.ProgramList"})})).then((function(t){var a=t.data;a.state=1===a.state||!0===a.state,n["a"].sortBy(a.child,{key:"weight",type:"min"}),n["a"].each(a.child,(function(e){n["a"].each(e.roleRatio,(function(e){var t=e.role||{};e.name=t.name,delete e.role}))})),e.formData=Object(i["a"])(Object(i["a"])({},e.formData),a)}))},handleProductCategory:function(){var e=this;this.$isHasMenuAuth("admin.ProductCategoryList")&&this.$Http.Post({mutation:this.$Model.ProductCategorys,variables:{perPage:0},fields:[{data:["id","name","pid"]}]}).then((function(t){var a=t.data;if(!n["a"].isEmpty(a.data)){n["a"].each(a.data,(function(e){e.title=e.name,e.value=e.id}));var r=e.$handleFindMenu(a.data);e.formTemp.categoryList=r}}))},handleGroupList:function(){var e=this;this.$isHasMenuAuth("admin.GroupList")&&this.$Http.Post({mutation:this.$Model.Groups,variables:{perPage:0},fields:[{data:["id","name"]}]}).then((function(t){var a=t.data;e.formTemp.groupList=a.data}))},handleFilterUserChange:function(e){var t={};n["a"].isEmpty(e)||(t={groups:{id:e}}),this.$refs.user.handleSlotWatch(t)},handleTargetChange:function(e){1===e&&(this.formData.rolesIds=[],this.formData.inJobTime=0)},handleRoleDataFunc:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(a){a.ratio=+e.$options.filters.toFixed(100/t.length),a.roleId=a.id,delete a.id})),this.formTemp.roles=t,n["a"].each(this.formData.child,(function(e){n["a"].isEmpty(e.roleRatio)&&(e.roleRatio=t)}))},handleisAllChange:function(){this.formData.productIds=[]},handleTableOnDragDrop:function(e,t){var a;(a=this.formData.child).splice.apply(a,[t,0].concat(Object(l["a"])(this.formData.child.splice(e,1))))},handleValueChange:function(e,t,a){this.formData.child[t][a]=e[a]},handleTyeValueChange:function(e,t,a){1===e.tye&&e.value>100&&(this.formData.child[t].value=100),this.handleValueChange(e,t,a)},handleRoleRatioChange:function(e,t,a){this.formData.child[t].roleRatio[a].ratio=e},handleAttrValueRemove:function(e){this.formData.child.splice(e,1)},handleAttrValueAdd:function(){var e=this.handleCheckEmptyAttrValue();!0!==e?n["a"].isRepeat(this.formData.child.map((function(e){return e.value})))?this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.ProgramType")+this.$t("dt.base.isBeRepeat")}):this.formData.child.push({label:1,value:0,tye:1===this.formData.tye?1:2,roleRatio:this.formTemp.roles||[]}):this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.ProgramType")+this.$t("dt.api.notEmpty")})},handleCheckEmptyAttrValue:function(){var e=this.formData.child;return e.filter((function(e){return n["a"].isEmpty(e.value)})).length>0},handleTreeSelectChange:function(e,t){if(n["a"].isEmpty(e))this.$refs.product.handleSlotWatch();else{var a=[t.id];t.expand=!0;var r=function e(t){n["a"].each(t,(function(t){a.push(t.id),n["a"].isEmpty(t.children)||e(t.children)}))};n["a"].isEmpty(t.children)||r(t.children),n["a"].isEmpty(a)||this.$refs.product.handleSlotWatch({categoryId_in:a})}},handleSumbitCheck:function(){var e=Object(i["a"])({},this.formData);n["a"].sortBy(e.child,{key:"label",type:"min"}),n["a"].each(e.child,(function(e,t){e.weight=t+1,e.label=1*e.label.toFixed(2),e.value=1*e.value.toFixed(2);var a=[];n["a"].each(e.roleRatio,(function(e){a.push({id:e.id||null,roleId:e.roleId,ratio:e.ratio})})),e.roleRatio=a})),this.handleSumbit(e)}}},c=m,u=(a("8048"),a("c701")),h=Object(u["a"])(c,r,o,!1,null,"b2b36266",null);t["a"]=h.exports}}]);