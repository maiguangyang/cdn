(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44e90e34"],{1637:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"RevokeProduct-list-page"},[r("div",{staticClass:"wrapper"},[r("div",{staticClass:"controller"},[r("Row",{staticClass:"filter-group",class:{active:t.rowToggle},attrs:{type:"flex",gutter:20}},[r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.OrderNo"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("Input",{attrs:{search:"",placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.OrderNo")})},on:{"on-enter":t.handleFilterChange,"on-search":t.handleFilterChange},model:{value:t.filters.orderNo_like,callback:function(e){t.$set(t.filters,"orderNo_like",e)},expression:"filters.orderNo_like"}})],1)],1)],1),t.$isHasMenuAuth("admin.SupplyList")?r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.Supply"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("ListSelectModal",{ref:"supply",attrs:{title:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.Supply")}),type:2,route:"SupplyAdd",api:t.$Model.Supplys,column:[{name:t.$t("dt.form.SupplyName")},{code:t.$t("dt.form.SupplyCode")},{telPhone:t.$t("dt.base.telPhone")},{remark:t.$t("dt.base.remark")}],attrs:{label:"name",value:"id"},filter:t.filter.supply,callback:t.handleFilterChange,placeholder:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.Supply")})},model:{value:t.filters.supplyId,callback:function(e){t.$set(t.filters,"supplyId",e)},expression:"filters.supplyId"}},[r("div",{staticClass:"filter-item",attrs:{slot:"filter"},slot:"filter"},[r("span",[t._v(t._s(t.$t("dt.form.SupplyCode"))+"：")]),r("Input",{attrs:{search:"","enter-button":"",placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.SupplyCode")})},on:{"on-enter":t.handleFilterSupplyCodeChange,"on-search":t.handleFilterSupplyCodeChange},model:{value:t.filter.supply.code_like,callback:function(e){t.$set(t.filter.supply,"code_like",e)},expression:"filter.supply.code_like"}})],1)])],1)],1)],1):t._e(),r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.RevokeProductType"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("Select",{attrs:{clearable:"",placeholder:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.RevokeProductType")})},on:{"on-change":t.handleFilterChange},model:{value:t.filters.tye,callback:function(e){t.$set(t.filters,"tye",e)},expression:"filters.tye"}},t._l(t.$options.filters.revokeProductType([]),(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1)],1),r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.RevokeProductStatus"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("Select",{attrs:{clearable:"",placeholder:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.RevokeProductStatus")})},on:{"on-change":t.handleFilterChange},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},t._l(t.$options.filters.revokeProductStatus([]),(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1)],1),r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.RelationOrder"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("Input",{attrs:{search:"",placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.RelationOrder")})},on:{"on-enter":t.handleFilterChange,"on-search":t.handleFilterChange},model:{value:t.filters.relationOrder,callback:function(e){t.$set(t.filters,"relationOrder",e)},expression:"filters.relationOrder"}})],1)],1)],1),t.$isHasMenuAuth("admin.UserList")?r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.form.Operator"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("ListSelectModal",{attrs:{title:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.Operator")}),type:2,route:"UserAdd",api:t.$Model.Users,column:[{username:t.$t("dt.form.UserName")},{phone:t.$t("dt.base.telPhone")}],attrs:{label:"username",value:"id"},callback:t.handleFilterChange,placeholder:t.$t("dt.base.pleaseSelect",{label:t.$t("dt.form.Operator")})},model:{value:t.filters.userId,callback:function(e){t.$set(t.filters,"userId",e)},expression:"filters.userId"}})],1)],1)],1):t._e(),r("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[r("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[r("Col",{staticClass:"child-title",attrs:{span:"8"}},[r("span",[t._v(t._s(t.$t("dt.base.sort"))+"：")])]),r("Col",{attrs:{span:"16"}},[r("sorts",{on:{swtichSorts:t.handleFilterChange}})],1)],1)],1),r("button",{staticClass:"row-toggle",attrs:{type:"button"},on:{click:function(e){return t.$store.commit("spinShow/rowToggle")}}},[t.rowToggle?r("Icon",{attrs:{type:"ios-arrow-up",size:"25",color:"#999"}}):r("Icon",{attrs:{type:"ios-arrow-down",size:"25",color:"#999"}})],1)],1),r("div",{staticClass:"btn-group"},[r("div",{staticClass:"left"},[t.$isHasMenuAuth("admin.RevokeProductAdd")?r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleCheckHabitType({name:"admin.RevokeProductAdd"})}}},[r("Icon",{attrs:{type:"md-add"}}),t._v(t._s(t.$t("dt.form.RevokeProductAdd"))+" ")],1):t._e()],1),r("div",{staticClass:"right"},[t.$isHasMenuAuth("admin.RevokeProductExport")?r("Button",{attrs:{type:"warning"},on:{click:t.handleAsyncExport}},[r("Icon",{attrs:{type:"md-cloud-download"}}),t._v(t._s(t.$t("dt.form.export"))+"Excel ")],1):t._e()],1)]),r("div",{staticClass:"table"},[r("Table",{ref:"selection",attrs:{border:"",loading:t.loading&&t.isMethodList,columns:t.columns,data:t.formTemp.data},on:{"on-select-cancel":t.handleTableOnSelectCancel,"on-selection-change":t.handleTableSelectionChange}})],1),r("div",{staticClass:"page-list"},[r("Page",{attrs:{"show-total":"","show-sizer":"","show-elevator":"",total:t.formTemp.total,current:t.formTemp.current_page,"page-size-opts":t.formTemp.pageSizeOpts,"page-size":t.formTemp.per_page},on:{"on-page-size-change":t.handleOnPageSizeChange,"on-change":t.handleChangePage}})],1)],1)])])},s=[],o=(r("2d38"),r("2c78"),r("5c4c"),r("d211")),l=r("b8f9"),i=r("efa4"),n=r("494e"),d={name:"RevokeProductList",mixins:[i["a"]],data:function(){return{filter:{supply:{}},formTemp:{warehouseList:[],supplyList:[],relationOrder:null}}},components:{ListSelectModal:n["a"]},computed:{columns:function(){var t=this;return[{title:this.$t("dt.form.index"),type:"index",width:80,align:"center",fixed:"left"},{title:this.$t("dt.form.OrderNo"),key:"orderNo",width:200,align:"center",render:function(e,r){return e(t.$isHasMenuAuth("admin.RevokeProductDetail")?"router-link":"span",{props:{to:{name:"admin.RevokeProductDetail",params:{id:r.row.id}}}},r.row.orderNo)}},{title:this.$t("dt.form.RevokeProductMoney"),key:"money",width:120,align:"center",render:function(e,r){var a=r.row.money||0;return e("span","".concat(t.$options.filters.money(a)," ").concat(t.$t("dt.base.unit")))}},{title:this.$t("dt.form.RevokeProductProject"),minWidth:100,align:"center",render:function(e,r){var a=r.row.detail||[];return e("span","".concat(a.length," ").concat(t.$t("dt.base.term")))}},{title:this.$t("dt.form.RevokeProductNumber"),key:"number",minWidth:100,align:"center",render:function(e,r){return e("span","".concat(r.row.number," ").concat(t.$t("dt.base.piece")))}},{title:this.$t("dt.form.RevokeProductType"),key:"tye",minWidth:150,align:"center",render:function(e,r){return e("span",t.$options.filters.revokeProductType(r.row.tye))}},{title:this.$t("dt.form.RelationOrder"),key:"orderNo",width:200,align:"center",render:function(e,r){var a=r.row.tye,s=r.row.purchase||{};return 2===a&&(s=r.row.salesOrder||{}),e("span",s.orderNo||t.$t("dt.form.StockRevoke"))}},{title:this.$t("dt.form.RevokeProductSupply"),minWidth:200,align:"center",render:function(e,r){var a=r.row.supply||{};return e("span",a.name||t.$t("dt.base.Nothing"))}},{title:this.$t("dt.form.Operator"),minWidth:200,align:"center",render:function(t,e){var r=e.row.user||{};return t("span",r.username)}},{title:this.$t("dt.base.telPhone"),minWidth:200,align:"center",render:function(t,e){var r=e.row.user||{};return t("span",r.phone)}},{title:this.$t("dt.base.remark"),key:"remark",minWidth:200,maxWidth:300,tooltip:!0,align:"center"},{title:this.$t("dt.form.createdAt"),key:"createdAt",width:170,align:"center",sortable:!0,render:function(e,r){return e("span",t.$options.filters.formatTime(r.row.createdAt))}},{title:this.$t("dt.form.RevokeProductStatus"),key:"status",width:120,align:"center",fixed:"right",render:function(e,r){var a=r.row.status,s="#2d8cf0";return 2===a?s="#ff9900":3===a?s="#19be6b":4===a&&(s="#c5c8ce"),1===r.row.status?e("Tooltip",{props:{content:t.$t("dt.base.click",{label:t.$t("dt.form.Start")+t.$t("dt.form.Revoke")}),placement:"top",transfer:!0}},[e("span",{style:{cursor:"pointer",color:s},on:{click:function(){t.$Modal.confirm({title:t.$t("dt.toast.tips"),content:"".concat(t.$t("dt.base.whether")).concat(t.$t("dt.form.Start")+t.$t("dt.form.Revoke"),"?"),loading:!0,closable:!0,onOk:function(){t.handleRevokeProduct(r.row,2)}})}}},t.$options.filters.revokeProductStatus(a))]):e("span",{style:{color:s}},t.$options.filters.revokeProductStatus(a))}},{title:this.$t("dt.form.action"),key:"action",width:120,align:"center",fixed:"right",render:function(e,r){var a=[];return t.$isHasMenuAuth("admin.RevokeProductDetail")&&a.push(e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCheckHabitType({name:"admin.RevokeProductDetail",params:{id:r.row.id}})}}},t.$t("dt.form.detail"))),t.$isHasMenuAuth("admin.PutStockAdd")&&2===r.row.tye&&3===r.row.status&&1===r.row.isPut&&a.push(e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCheckHabitType({name:"admin.PutStockAdd",query:{type:2}})}}},t.$t("dt.form.RevokeProductPutStock"))),t.$isHasMenuAuth("admin.RevokeProductEdit")&&2===r.row.status&&a.push(e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$Modal.confirm({title:t.$t("dt.toast.tips"),content:"".concat(t.$t("dt.base.whether")).concat(t.$t("dt.form.RevokeProductComplete"),"?"),loading:!0,closable:!0,onOk:function(){t.handleRevokeProduct(r.row,3)}})}}},t.$t("dt.form.Complete"))),t.$isHasMenuAuth("admin.RevokeProductEdit")&&2===r.row.status&&a.push(e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$Modal.confirm({title:t.$t("dt.toast.tips"),content:"".concat(t.$t("dt.base.whether")).concat(t.$t("dt.form.cancel"),"?"),loading:!0,closable:!0,onOk:function(){t.handleRevokeProduct(r.row,4)}})}}},t.$t("dt.form.cancel"))),t.$isHasMenuAuth("admin.RevokeProductEdit")&&1===r.row.status&&a.push(e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCheckHabitType({name:"admin.RevokeProductEdit",params:{id:r.row.id}})}}},t.$t("dt.form.edit"))),t.$isHasMenuAuth("admin.RevokeProductDelete")&&1===r.row.status&&a.push(e("Button",{props:{type:l["a"].isEmpty(r.row.deletedAt)?"error":"success",size:"small"},on:{click:function(){l["a"].isEmpty(r.row.deletedAt)?t.handleAsync(r):t.handleRecoveryAsync(r)}}},l["a"].isEmpty(r.row.deletedAt)?t.$t("dt.form.delete"):t.$t("dt.form.recovery"))),e("div",a)}}]}},created:function(){this.handleList()},mounted:function(){},watch:{},filters:{},methods:{handleList:function(){var t=this,e=this.handleInitFields(this.columns,["isPut","warehouseId","purchaseId","salesOrderId","supply.id","supply.name","user.id","user.username","user.phone","purchase.id","purchase.orderNo","salesOrder.id","salesOrder.orderNo","detail.id","detail.number","detail.skuId","detail.productDetailId","detail.salesOrderDetailId"]),r=this.variables;this.filters.relationOrder&&(r.filter=Object(o["a"])(Object(o["a"])({},r.filter),{},{OR:[{purchase:{orderNo_like:this.filters.relationOrder}},{salesOrder:{orderNo_like:this.filters.relationOrder}}]}),delete r.filter.relationOrder),this.$Http.Post({mutation:this.$Model.PurchaseRevokeProducts,variables:r,fields:e}).then((function(e){var r=e.data;t.formTemp=Object(o["a"])(Object(o["a"])({},t.formTemp),r),t.sortData(t.formTemp.data)}))},sortData:function(){var t=this;l["a"].each(this.formTemp.data,(function(e,r){e.index=(t.formTemp.current_page-1)*t.formTemp.per_page+r+1,e.loading=!1}))},handleRevokeProduct:function(t,e){var r=this,a=Object(o["a"])({},t);a.status=e||2,this.handleRowItemSave(a,(function(e){l["a"].isEmpty(e)||(r.$Message.success("".concat(r.$t("dt.form.action")).concat(r.$t("dt.status.success"))),t.status=a.status,r.$Modal.remove())}))},handleRelationOrderChange:function(t){var e=t.target.value;this.filters.purchase||(this.filters.purchase={}),this.filters.salesOrder||(this.filters.salesOrder={}),this.filters.purchase.orderNo_like=e,l["a"].isEmpty(this.filters.purchase)&&delete this.filters.purchase,l["a"].isEmpty(this.filters.salesOrder)&&delete this.filters.salesOrder},handleFilterSupplyCodeChange:function(){this.filter.supply.code_like||delete this.filter.supply.code_like,this.$refs.supply.handleSlotWatch()},handleRowItemSave:function(t,e){l["a"].isEmpty(t)||this.handleOnRecovery({api:this.$Model.PurchaseRevokeProductEdit,item:t,type:2},e)},handleUpdateStatus:function(t,e){this.handleUpdateStatusFunc({api:this.$Model.PurchaseRevokeProductEdit,item:t,value:e})},handleRecovery:function(t,e){l["a"].isEmpty(t)||this.handleOnRecovery({api:this.$Model.PurchaseRevokeProductsRecovery,item:t},e)},handleDelete:function(t){l["a"].isEmpty(t.id)||l["a"].isEmpty(t.index)||this.handleOnDelete({api:this.$Model.PurchaseRevokeProductsDelete,item:t})}}},c=d,u=(r("6958"),r("c701")),p=Object(u["a"])(c,a,s,!1,null,"71a455ba",null);e["default"]=p.exports},6958:function(t,e,r){"use strict";r("ae9a")},ae9a:function(t,e,r){}}]);