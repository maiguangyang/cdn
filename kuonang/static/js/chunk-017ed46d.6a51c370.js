(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-017ed46d"],{"212c":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("2d38"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("2c78"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("1b8a"),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("9953"),core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_find_index__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("422c"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("69bf"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("64fe"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("02bf"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a39b"),core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("90d4"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("5c4c"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("4798"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_number_to_fixed__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("4037"),core_js_modules_es_number_to_fixed__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_number_to_fixed__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("d8f4"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("2083"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("1f90"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_15__),D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("d211"),_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("b8f9"),_admin_mixin_list__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("efa4"),_admin_mixin_model__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("4ec25"),_admin_components_ListSelectModal__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("494e");__webpack_exports__["a"]={name:"PurchaseOrderModel",mixins:[_admin_mixin_model__WEBPACK_IMPORTED_MODULE_19__["a"],_admin_mixin_list__WEBPACK_IMPORTED_MODULE_18__["a"]],data:function(){var e=this;return{open:!1,modelWidth:1024,cartesianList:[],currentProduct:[],currentDividend:{},filters:{product:{},sku:{}},formTemp:{data:[],productData:[],oldData:[],productList:[],filters:{},categoryList:[],dividendList:[],collection:[],warehouseList:[]},formData:{status:1,deliverType:3,dividendId:"0",taxMoney:0,costPrice:0,targetUser:[],number:0,target:1,money:0,isPay:3,payMoney:0,userId:this.$UserInfo.id,detail:[],logisticId:null},columns:[{title:this.$t("dt.form.action"),key:"action",width:80,align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.formTemp.data.splice(a.index,1),e.formData.money=e.formTemp.data.map((function(e){return Number(e.unitPrice)})).reduce((function(e,t){return e+t}),0)}}},e.$t("dt.form.delete"))}},{title:this.$t("dt.form.Product"),oldTitle:this.$t("dt.form.Product"),align:"center",children:[{title:this.$t("dt.form.SkuCode"),key:"skuCode",minWidth:120,align:"center",render:function(t,a){return t("span",a.row.skuCode||e.$t("dt.base.Nothing"))}},{title:this.$t("dt.form.name"),key:"label",minWidth:200,align:"center"},{title:this.$t("dt.form.Spec"),key:"name",minWidth:200,align:"center",render:function(t,a){return t("span",a.row.name||e.$t("dt.base.Nothing"))}}]},{title:this.$t("dt.form.StockInfo"),align:"center",children:[{title:this.$t("dt.form.Warehouse"),key:"warehouse",minWidth:120,align:"center"},{title:this.$t("dt.form.Location"),key:"location",minWidth:120,align:"center"},{title:this.$t("dt.form.ArticleNo"),key:"article",minWidth:150,align:"center"}]},{title:this.$t("dt.base.UnitPrice"),key:"unitPrice",width:120,align:"center",renderHeader:function(t,a){var r=a.column;return e.isReadonly?t("span",r.title):t("div",[t("span",r.title),t("e-input",{props:{title:e.$t("dt.form.batch"),open:!0,isIntType:!0,columnKey:r.key},on:{handleDropdownInput:e.handleBatchAllMoney}})])},render:function(t,a){var r=a.row.unitPrice;return t("InputNumber",{props:{value:r,size:"small",min:0,clearable:!e.isReadonly,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.UnitPrice")})},on:{input:function(t){e.handleCheckMoney(t,e.formTemp.data[a.index],[a.column.key])}}},r)}},{title:this.$t("dt.base.Number"),key:"number",width:120,align:"center",renderHeader:function(t,a){var r=a.column;return e.isReadonly?t("span",r.title):t("div",[t("span",r.title),t("e-input",{props:{title:e.$t("dt.form.batch"),open:!0,isIntType:!0,columnKey:r.key},on:{handleDropdownInput:e.handleBatchAllMoney}})])},render:function(t,a){var r=a.row.number;return t("InputNumber",{props:{value:r,size:"small",min:1,max:a.row.maxNumber,clearable:!0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.Number")})},on:{input:function(t){e.handleCheckMoney(t,e.formTemp.data[a.index],[a.column.key])}}},r)}},{title:this.$t("dt.base.isTax"),key:"taxType",width:150,align:"center",renderHeader:function(t,a){var r=a.column;return e.isReadonly?t("span",r.title):t("div",[t("span",r.title),t("e-dropdown",{props:{open:!0,title:e.$t("dt.form.batch"),columnKey:r.key,name:"label",value:"value",dataList:e.$options.filters.taxType([])},on:{handleDropdownChange:function(t){_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(e.formTemp.data,(function(e){e[t.key]=t.data}))}}})])},render:function(t,a){return t("RadioGroup",{props:{value:a.row.taxType,size:"small"},on:{"on-change":function(t){e.handleCheckMoney(t,e.formTemp.data[a.index],[a.column.key])}}},[t("Radio",{props:{label:1,disabled:e.isReadonly}},e.$t("dt.base.NotTax")),t("Radio",{props:{label:2,disabled:e.isReadonly}},e.$t("dt.base.HasTax"))])}},{title:this.$t("dt.base.OutTax"),key:"tax",width:120,align:"center",renderHeader:function(t,a){var r=a.column;return e.isReadonly?t("span",r.title):t("div",[t("span",r.title),t("e-input",{props:{title:e.$t("dt.form.batch"),open:!0,isIntType:!0,columnKey:r.key},on:{handleDropdownInput:e.handleBatchAllMoney}})])},render:function(t,a){var r=a.row.tax;return t("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},[t("InputNumber",{props:{value:r,size:"small",min:0,clearable:!0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.OutTax")})},on:{input:function(t){e.handleCheckMoney(t,e.formTemp.data[a.index],[a.column.key])}}}),t("span",{style:{marginLeft:"5px"}},"%")])}},{title:this.$t("dt.base.Discount"),key:"discount",width:120,align:"center",renderHeader:function(t,a){var r=a.column;return e.isReadonly?t("span",r.title):t("div",[t("span",r.title),t("e-input",{props:{title:e.$t("dt.form.batch"),open:!0,isIntType:!0,columnKey:r.key},on:{handleDropdownInput:e.handleBatchAllMoney}})])},render:function(t,a){var r=a.row.discount;return t("InputNumber",{props:{value:r,size:"small",max:10,min:1,step:.1,clearable:!0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.Discount")})},on:{input:function(t){e.handleCheckMoney(t,e.formTemp.data[a.index],[a.column.key])}}},r)}},{title:this.$t("dt.base.PayablePrice"),align:"center",children:[{title:this.$t("dt.base.NotTax"),key:"payablePriceNotTax",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.payablePriceNotTax," ").concat(e.$t("dt.base.unit")))}},{title:this.$t("dt.base.HasTax"),key:"payablePrice",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.payablePrice," ").concat(e.$t("dt.base.unit")))}}]},{title:this.$t("dt.base.DiscountPrice"),align:"center",children:[{title:this.$t("dt.base.NotTax"),key:"discountPriceNotTax",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.discountPriceNotTax," ").concat(e.$t("dt.base.unit")))}},{title:this.$t("dt.base.HasTax"),key:"discountPrice",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.discountPrice," ").concat(e.$t("dt.base.unit")))}}]},{title:this.$t("dt.base.PaymentPrice"),align:"center",children:[{title:this.$t("dt.base.NotTax"),key:"paymentPriceNotTax",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.paymentPriceNotTax," ").concat(e.$t("dt.base.unit")))}},{title:this.$t("dt.base.HasTax"),key:"paymentPrice",width:120,align:"center",render:function(t,a){return t("span","".concat(a.row.paymentPrice," ").concat(e.$t("dt.base.unit")))}}]},{title:this.$t("dt.base.TaxMoney"),key:"taxMoney",minWidth:150,align:"center",render:function(t,a){return t("span","".concat(e.$options.filters.toFixed(a.row.taxMoney)," ").concat(e.$t("dt.base.unit")))}},{title:this.$t("dt.form.CostPrice"),key:"costPrice",minWidth:150,align:"center",renderHeader:function(t,a){var r=a.column;return t("div",[t("span",r.title),t("Tooltip",{props:{transfer:!0,placement:"top",content:e.$t("dt.toast.MovingAverageWeightingMethod")}},[t("Icon",{props:{size:"16",color:"#f90",type:"ios-alert-outline"}})])])},render:function(t,a){return t("span","".concat(e.$options.filters.toFixed(a.row.costPrice)," ").concat(e.$t("dt.base.unit")))}},{title:this.$t("dt.form.OrderProfit"),key:"profit",width:120,align:"center",render:function(t,a){return t("span","".concat(e.$options.filters.toFixed(a.row.profit)," ").concat(e.$t("dt.base.unit")))}}],colData:[{title:this.$t("dt.form.ProductName"),minWidth:120,align:"center",render:function(e,t){var a=t.row.product||{};return e("span",a.name)}},{title:this.$t("dt.form.SkuName"),minWidth:120,align:"center",render:function(t,a){var r=a.row.sku||{};return t("span",r.label||e.$t("dt.base.Nothing"))}},{title:this.$t("dt.form.Warehouse"),width:150,align:"center",filters:[],filterMultiple:!1,filterMethod:function(e,t){return t.warehouse.id===e},render:function(e,t){var a=t.row.warehouse||{};return e("span",a.name)}},{title:this.$t("dt.form.StockNumber"),key:"stock",width:100,align:"center",render:function(t,a){var r={};return a.row.stock>0&&(r.color="#2d8cf0",r.cursor="pointer"),t("span",{style:r},"".concat(a.row.stock," ").concat(e.$t("dt.base.piece")))}},{title:this.$t("dt.form.LockStock"),key:"lockStock",width:100,align:"center",render:function(t,a){var r={};return a.row.lockStock>0&&(r.color="#ed4014",r.cursor="pointer"),t("span",{style:r},"".concat(a.row.lockStock," ").concat(e.$t("dt.base.piece")))}},{title:this.$t("dt.form.SalesPrice"),key:"unitPrice",width:110,align:"center",render:function(t,a){var r=a.row.unitPrice;return t("InputNumber",{style:{width:"65px"},props:{value:r,size:"small",min:0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.SalesPrice")})},on:{input:function(t){e.formTemp.productData[a.index].unitPrice=t}}},r)}},{title:this.$t("dt.form.PlaceOrderNumber"),key:"number",width:110,align:"center",render:function(t,a){var r=a.row.number;return t("InputNumber",{style:{width:"65px"},props:{value:r,size:"small",min:0,max:a.row.maxNumber,disabled:a.row.maxNumber<=0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.PlaceOrderNumber")})},on:{input:function(t){e.formTemp.productData[a.index].number=t}}},r)}}],ruleInline:{customerId:[{required:!0,message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.Customer")}),trigger:"blur"}],weight:[{required:!0,type:"number",message:this.$t("dt.form.weightPlaceholder"),trigger:"blur"},{validator:this.$Validator("number",this.$t("dt.form.weightPlaceholder")),trigger:"blur"}]}}},created:function(){this.handleProductCategory(),this.handleDividendList(),this.handleCollectionList(),this.handleWarehouseList(),_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(this.id)||(this.isReadonly&&this.columns.splice(0,1),this.handleDetail())},mounted:function(){window.aa=this},destroyed:function(){this.$apollo.getClient().cache.reset()},components:{ListSelectModal:_admin_components_ListSelectModal__WEBPACK_IMPORTED_MODULE_20__["a"]},watch:{"formData.money":function(e,t){e!==t&&(this.formData.payMoney=e)}},methods:{handleDetail:function(){var e=this;this.$Http.Post({mutation:this.$Model.SalesOrderDetail,variables:{id:this.id},fields:["id","orderNo","money","target","targetUser","tye","status","deliverType","waybillNo","isPay","payMoney","dividendId","collectionId","costPrice","remark","weight","state","customerId","logisticId","userId","branchId","detail.id","detail.label","detail.name","detail.skuPicture","detail.number","detail.tax","detail.taxType","detail.unitPrice","detail.discount","detail.payablePrice","detail.payablePriceNotTax","detail.discountPrice","detail.discountPriceNotTax","detail.paymentPrice","detail.paymentPriceNotTax","detail.costPrice","detail.warehouse","detail.location","detail.article","detail.productId","detail.product.id","detail.product.name","detail.skuId","detail.sku.id","detail.sku.skuCode","detail.warehouseProductId","detail.warehouseProduct.id","detail.warehouseProduct.stock","detail.warehouseProduct.lockStock"]},(function(){e.$router.push({name:"admin.SalesOrderList"})})).then((function(t){var a=t.data;a.state=1===a.state||!0===a.state,e.handleDividendChange(a.dividendId),a.money=1*e.$options.filters.money(a.money),a.payMoney=1*e.$options.filters.money(a.payMoney),_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(a.targetUser)?a.targetUser=[]:a.targetUser=a.targetUser.split(),e.formTemp.data=a.detail||[],_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(e.formTemp.data,(function(t){var a=1*e.$options.filters.money(t.unitPrice),r=e.$options.filters.money(t.costPrice);t.skuId=t.sku.id,t.skuCode=t.sku.skuCode,t.unitPrice=a,t.payablePrice=e.$options.filters.money(t.payablePrice),t.payablePriceNotTax=e.$options.filters.money(t.payablePriceNotTax),t.discountPrice=e.$options.filters.money(t.discountPrice),t.discountPriceNotTax=e.$options.filters.money(t.discountPriceNotTax),t.paymentPrice=e.$options.filters.money(t.paymentPrice),t.paymentPriceNotTax=e.$options.filters.money(t.paymentPriceNotTax),t.maxNumber=t.warehouseProduct.stock-t.warehouseProduct.lockStock-t.number,t.taxMoney=t.paymentPrice-t.paymentPriceNotTax,t.costPrice=r,t.averageCostPrice=r/t.number,t.profit=a-1*r})),e.formData=Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])(Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])({},e.formData),a)}))},handleDividendList:function(){var e=this;this.$isHasMenuAuth("admin.ProgramList")&&this.$Http.Post({mutation:this.$Model.Dividends,variables:{perPage:0},fields:[{data:["id","name","target","inJobTime"]}]}).then((function(t){var a=t.data,r=[{id:"0",name:e.$t("dt.base.Nothing")}];e.formTemp.dividendList=r.concat(a.data)}))},handleWarehouseList:function(){var e=this;this.$isHasMenuAuth("admin.WarehouseList")&&this.$Http.Post({mutation:this.$Model.Warehouses,variables:{perPage:0},fields:[{data:["id","name"]}]}).then((function(t){var a=t.data;e.formTemp.warehouseList=a.data}))},handleCollectionList:function(){var e=this;this.$isHasMenuAuth("admin.CollectionList")&&this.$Http.Post({mutation:this.$Model.Collections,variables:{perPage:0},fields:[{data:["id","name"]}]}).then((function(t){var a=t.data;e.formTemp.collection=a.data}))},handleProductCategory:function(){var e=this;this.$isHasMenuAuth("admin.ProductCategoryList")&&this.$Http.Post({mutation:this.$Model.ProductCategorys,variables:{perPage:0},fields:[{data:["id","name","pid"]}]}).then((function(t){var a=t.data;if(!_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(a.data)){_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(a.data,(function(e){e.title=e.name,e.value=e.id}));var r=e.$handleFindMenu(a.data);e.formTemp.categoryList=r}}))},handleTreeSelectChange:function(e,t){if(!_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(e)){var a=[t.id];t.expand=!0;var r=function e(t){_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(t,(function(t){a.push(t.id),_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(t.children)||e(t.children)}))};_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(t.children)||r(t.children),_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(a)||this.handleList({filter:{product:{categoryId_in:a}}})}},handleList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])(Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])({},this.variables),t);var a=this.handleInitFields([],["id","stock","lockStock","product.id","product.name","sku.id","sku.label","sku.skuPicture","sku.salesPrice","sku.skuCode","sku.costPrice","warehouse.id","warehouse.name","location.id","location.name","article.id","article.name"]);this.$Http.Post({mutation:this.$Model.WarehouseProducts,variables:Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])({},t),fields:a}).then((function(t){var a=t.data,r=[];_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(a.data,(function(t){t.number=0,t.unitPrice=1*e.$options.filters.money(t.sku.salesPrice),t.maxNumber=t.stock-t.lockStock;var a=e.formData.detail.find((function(e){return e.skuId===t.sku.id&&e.warehouseProductId===t.id}));_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(a)||(t.maxNumber+=a.number),r.push({label:t.warehouse.name,value:t.warehouse.id})})),e.colData[2].filters=_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].uniqBy(r,"value"),e.formTemp.productData=a.data,e.formTemp.total=a.total}))},handleProductModelOnOk:function(){var e=this,t=[],a=this.formTemp.productData.filter((function(e){return e.number>0}));_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(a,(function(a){var r=e.formTemp.data.findIndex((function(e){return e.skuId===a.sku.id&&e.warehouseProductId===a.id}));-1!==r&&e.formTemp.data.splice(r,1);var o=a.number,i=a.unitPrice||0,n=o*i,s=e.$options.filters.formatMoney(o*i),l=e.$options.filters.formatMoney(n),_=e.$options.filters.money(a.sku.costPrice);t.push({warehouseProductId:a.id,skuCode:a.sku.skuCode,label:a.product.name,productId:a.product.id,name:a.sku.label,skuId:a.sku.id,skuPicture:a.sku.skuPicture,taxMoney:0,costPrice:_,averageCostPrice:_,profit:i-1*_,number:o,maxNumber:a.maxNumber,unitPrice:a.unitPrice,taxType:2,tax:0,discount:10,payablePriceNotTax:s,payablePrice:e.$options.filters.formatMoney(1*s*1),discountPriceNotTax:e.$options.filters.formatMoney(s-l),discountPrice:e.$options.filters.formatMoney(s-l),paymentPriceNotTax:l,paymentPrice:e.$options.filters.formatMoney(1*l*1),warehouse:a.warehouse.name||null,location:a.location.name||null,article:a.article.map((function(e){return e.name})).join()})})),this.formTemp.data=this.formTemp.data.concat(t),this.formTemp.productData=[],this.filters={product:{},sku:{}},this.open=!1},handleSpan:function(e){var t=e.row,a=e.column,r=e.rowIndex;if(-1===this.currentProduct.map((function(e){return e.label})).indexOf(t[a.key]))return[1,1];var o=t[a.key];if(r>0&&o===this.formTemp.data[r-1][a.key])return[0,0];for(var i=[1,1],n=r+1;n<this.formTemp.data.length&&o===this.formTemp.data[n][a.key];n++)++i[0];return i},handleTableSummary:function(e){var t=this,a=e.columns,r=e.data,o={};return a.forEach((function(e,a){var i=e.key,n=[0,1,2,3,4,5,6,9,10,11];if(-1===n.indexOf(a)){var s=r.map((function(e){return Number(e[i])}));if(_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(s))o[i]={key:i,value:null};else{var l=s.reduce((function(e,t){return e+t}),0);19===a&&(t.formData.costPrice=l),8===a?o[i]={key:i,value:"".concat(l," ").concat(t.$t("dt.base.piece"))}:(o[i]={key:i,value:"".concat(t.$options.filters.formatMoney(l)," ").concat(t.$t("dt.base.unit"))},"paymentPrice"===i&&(t.formData.money=l))}}else o[i]={key:i,value:null}})),o},handleCheckMoney:function(e,t,a){if(!this.$rules.checkMoney(e))return this.$Message.error(this.$t("dt.toast.PleaseEnterTheCorrectAmount")),void(t[a]=null);t[a]=e;var r=t.unitPrice||0,o=t.number*r*Number((t.discount/10).toFixed(2));t.payablePrice=this.$options.filters.formatMoney(t.number*r),t.paymentPrice=this.$options.filters.formatMoney(o),1===t.taxType?(t.paymentPriceNotTax=t.paymentPrice,t.paymentPrice=this.$options.filters.formatMoney(1*t.paymentPriceNotTax*(1+t.tax/100)),t.payablePriceNotTax=t.payablePrice,t.payablePrice=this.$options.filters.formatMoney(1*t.payablePriceNotTax*(1+t.tax/100))):(t.paymentPriceNotTax=this.$options.filters.formatMoney(1*t.paymentPrice/(1+t.tax/100)),t.payablePriceNotTax=this.$options.filters.formatMoney(1*t.payablePrice/(1+t.tax/100))),t.discountPrice=this.$options.filters.formatMoney(t.payablePrice-t.paymentPrice),t.discountPriceNotTax=this.$options.filters.formatMoney(t.payablePriceNotTax-t.paymentPriceNotTax),t.taxMoney=t.paymentPrice-t.paymentPriceNotTax,t.costPrice=t.averageCostPrice*t.number,t.profit=t.paymentPrice-1*t.costPrice},handleBatchAllMoney:function handleBatchAllMoney(){var _this10=this,obj=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(obj)&&_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isObject(obj)){var key=obj.key,data=obj.data||0;_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(this.formTemp.data,(function(item){_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(item.oldValue)&&(item.oldValue=Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])({},item));var value=_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(item.oldValue)?item[key]:item.oldValue[key];item[key]=_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(obj.operator)?data:eval("".concat(value).concat(obj.operator).concat(data)),"number"===key&&item[key]>item.maxNumber&&(item[key]=item.maxNumber);var unitPrice=item.unitPrice||0,price=item.number*unitPrice*Number((item.discount/10).toFixed(2));item.payablePrice=_this10.$options.filters.formatMoney(item.number*unitPrice),item.paymentPrice=_this10.$options.filters.formatMoney(price),1===item.taxType?(item.paymentPriceNotTax=item.paymentPrice,item.paymentPrice=_this10.$options.filters.formatMoney(1*item.paymentPriceNotTax*(1+item.tax/100)),item.payablePriceNotTax=item.payablePrice,item.payablePrice=_this10.$options.filters.formatMoney(1*item.payablePriceNotTax*(1+item.tax/100))):(item.paymentPriceNotTax=_this10.$options.filters.formatMoney(1*item.paymentPrice/(1+item.tax/100)),item.payablePriceNotTax=_this10.$options.filters.formatMoney(1*item.payablePrice/(1+item.tax/100))),item.discountPrice=_this10.$options.filters.formatMoney(item.payablePrice-item.paymentPrice),item.discountPriceNotTax=_this10.$options.filters.formatMoney(item.payablePriceNotTax-item.paymentPriceNotTax),item.taxMoney=item.paymentPrice-item.paymentPriceNotTax,item.costPrice=item.averageCostPrice*item.number,item.profit=item.paymentPrice-1*item.costPrice}))}},handleDeliverTypeChange:function(e){1!==e?(this.formData.logisticId=null,this.formData.waybillNo=null,delete this.ruleInline.logisticId,delete this.ruleInline.waybillNo):(this.ruleInline.logisticId=[{required:!0,message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.Logistic")}),trigger:"blur"}],this.ruleInline.waybillNo=[{required:!0,message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.form.WaybillNo")}),trigger:"blur"}])},handlePayChange:function(e){1===e?this.ruleInline.collectionId=[{required:!0,message:this.$t("dt.base.pleaseSelect",{label:this.$t("dt.form.Collection")}),trigger:"blur"}]:(this.formData.collectionId=null,delete this.ruleInline.collectionId),this.formData.payMoney=3===e?0:this.formData.money},handleDividendChange:function(e){this.formData.target=1,this.formData.targetUser=[];var t=this.formTemp.dividendList.find((function(t){return t.id===e}));this.currentDividend=t||{}},handleTargetChange:function(e){1===e&&(this.formData.targetUser=[])},handleSumbitCheck:function(){var e=this,t=Object(D_wwwroot_saas_vue_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_16__["a"])({},this.formData);if(this.formTemp.data.length<=0)this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:"".concat(this.$t("dt.form.Product")).concat(this.$t("dt.api.notEmpty"))});else{t.targetUser=t.targetUser.join(),t.money=1*this.$options.filters.formatMoney(100*t.money),t.payMoney=1*this.$options.filters.formatMoney(100*t.payMoney),t.costPrice=1*this.$options.filters.formatMoney(100*t.costPrice),t.number=0;var a=[],r=!1,o="";_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].each(this.formTemp.data,(function(i){_common_utils_lodash__WEBPACK_IMPORTED_MODULE_17__["a"].isEmpty(i.unitPrice)&&!r&&(r=!0,o="".concat(i.label," ").concat(i.name," ").concat(e.$t("dt.form.SalesPrice")).concat(e.$t("dt.api.notEmpty"))),t.number+=i.number,a.push({id:i.id||null,label:i.label,name:i.name,skuPicture:i.skuPicture,number:i.number,warehouse:i.warehouse,location:i.location,article:i.article,tax:i.tax,unitPrice:1*e.$options.filters.formatMoney(100*i.unitPrice),costPrice:1*e.$options.filters.formatMoney(100*i.costPrice),taxType:i.taxType,discount:i.discount,payablePrice:1*e.$options.filters.formatMoney(100*i.payablePrice),payablePriceNotTax:1*e.$options.filters.formatMoney(100*i.payablePriceNotTax),discountPrice:1*e.$options.filters.formatMoney(100*i.discountPrice),discountPriceNotTax:1*e.$options.filters.formatMoney(100*i.discountPriceNotTax),paymentPrice:1*e.$options.filters.formatMoney(100*i.paymentPrice),paymentPriceNotTax:1*e.$options.filters.formatMoney(100*i.paymentPriceNotTax),skuId:i.skuId,productId:i.productId,warehouseProductId:i.warehouseProductId})})),!0!==r?(t.detail=a,this.handleSumbit(t)):this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:o})}}}}},"269a":function(e,t,a){"use strict";a("b49a")},"4ec25":function(e,t,a){"use strict";a("6a61");var r=a("2e91"),o=a("d211"),i=a("5880"),n=a("b8f9"),s={data:function(){return{id:null,isReadonly:!1,formData:{branchId:this.$UserInfo.bid,state:!0,weight:1}}},props:{formData_bak:{type:Object,default:function(){return{}}},formModel:{type:Object,default:function(){return{}}},btnTitle:{type:String,default:""},tabName:{type:Array,default:function(){return[null]}}},created:function(){this.id=this.$GetParamsId(this),this.$FormCheck("*",this.formModel.readonly)&&(this.isReadonly=!0,this.ruleInline={})},computed:Object(o["a"])({},Object(i["mapState"])("base",{loading:function(e){return e.loading},isMethodList:function(e){return e.isMethodList}})),methods:{handleEmitData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData;this.$store.commit("popupModel/pageModal",{pageModal:!1}),this.$emit("formDataSubmit",{data:e})},handleFilterBranchChange:function(e){n["a"].isEmpty(e)||(this.formData.branchId=e)},handleSumbit:function(){var e=arguments,t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,i,s,l,_,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:t.formData,i=e.length>1&&void 0!==e[1]?e[1]:"form",o.state=!0===o.state||1*o.state===1?1:2,s=!0,l=!1,!n["a"].isString(i)){a.next=16;break}if(t.$refs[i]){a.next=11;break}s=!1,l=!0,a.next=14;break;case 11:return a.next=13,t.$refs[i].validate((function(e){return e}));case 13:l=a.sent;case 14:a.next=22;break;case 16:if(!n["a"].isArray(i)){a.next=22;break}return _=!0,n["a"].each(i,function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs[a]?t.$refs[a].validate((function(e){!1===e&&!0===_&&(_=!1)})):(s=!1,_=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.next=21,_;case 21:l=a.sent;case 22:if(!1!==s||!0!==l){a.next=25;break}return t.handleEmitData(o),a.abrupt("return");case 25:if(!1!==l){a.next=28;break}return t.$Message.error(t.$t("dt.form.checkFormComplete")),a.abrupt("return");case 28:d=t.$store.state.popupModel.pageModal,!0===d&&t.$store.commit("popupModel/loadData",{loadData:!0}),t.handleEmitData(o);case 31:case"end":return a.stop()}}),a)})))()}}};t["a"]=s},b49a:function(e,t,a){},f379:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content-layer"},[a("Tabs",{staticClass:"tabs",attrs:{type:"card"}},[a("TabPane",{attrs:{label:e.tabName[0]}},[a("Form",{ref:"form",staticClass:"form-page",attrs:{"label-position":"right","label-width":100,model:e.formData,rules:e.ruleInline}},[a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("customerId",e.formModel.hide),expression:"!$FormCheck('customerId', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.Customer"),prop:"customerId"}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Customer")}),route:"CustomerAdd",type:2,api:e.$Model.Customers,column:[{name:e.$t("dt.form.CustomerName")},{telPhone:e.$t("dt.base.telPhone")},{remark:e.$t("dt.base.remark")}],attrs:{label:"name",value:"id"},readonly:e.$FormCheck("customerId",e.formModel.readonly),clearable:!e.$FormCheck("customerId",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Customer")})},model:{value:e.formData.customerId,callback:function(t){e.$set(e.formData,"customerId",t)},expression:"formData.customerId"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("deliverType",e.formModel.hide),expression:"!$FormCheck('deliverType', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:8}},[a("FormItem",{attrs:{label:e.$t("dt.form.DeliverType"),prop:"deliverType"}},[a("Select",{attrs:{disabled:e.$FormCheck("deliverType",e.formModel.readonly),readonly:e.$FormCheck("deliverType",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.DeliverType")})},on:{"on-change":e.handleDeliverTypeChange},model:{value:e.formData.deliverType,callback:function(t){e.$set(e.formData,"deliverType",t)},expression:"formData.deliverType"}},e._l(e.$options.filters.deliverType([]),(function(t){return a("Option",{key:t.value,attrs:{disabled:e.$FormCheck("deliverType",e.formModel.readonly),value:t.value,label:t.label}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:1===e.formData.deliverType,expression:"formData.deliverType === 1"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.WaybillNo")}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Logistic")}),route:"LogisticAdd",type:2,api:e.$Model.Logistics,column:[{name:e.$t("dt.form.LogisticName")},{phone:e.$t("dt.base.telPhone")},{remark:e.$t("dt.base.remark")}],attrs:{label:"name",value:"id"},readonly:e.$FormCheck("userId",e.formModel.readonly),clearable:!e.$FormCheck("logisticId",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Logistic")})},model:{value:e.formData.logisticId,callback:function(t){e.$set(e.formData,"logisticId",t)},expression:"formData.logisticId"}}),a("Input",{directives:[{name:"show",rawName:"v-show",value:e.formData.logisticId,expression:"formData.logisticId"}],attrs:{readonly:e.$FormCheck("waybillNo",e.formModel.readonly),clearable:!e.$FormCheck("waybillNo",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.WaybillNo")})},model:{value:e.formData.waybillNo,callback:function(t){e.$set(e.formData,"waybillNo",t)},expression:"formData.waybillNo"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("isPay",e.formModel.hide),expression:"!$FormCheck('isPay', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.IsPay"),prop:"isPay"}},[a("Select",{attrs:{disabled:e.$FormCheck("isPay",e.formModel.readonly),readonly:e.$FormCheck("isPay",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.IsPay")})},on:{"on-change":e.handlePayChange},model:{value:e.formData.isPay,callback:function(t){e.$set(e.formData,"isPay",t)},expression:"formData.isPay"}},e._l(e.$options.filters.isPay([]),(function(t){return a("Option",{key:t.value,attrs:{disabled:e.$FormCheck("isPay",e.formModel.readonly),value:t.value,label:t.label}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:3!==e.formData.isPay,expression:"formData.isPay !== 3"}],staticClass:"input-item form-item-flex",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:1===e.formData.isPay,expression:"formData.isPay === 1"}],attrs:{label:e.$t("dt.form.Collection"),prop:"collectionId"}},[a("Select",{attrs:{readonly:e.$FormCheck("collectionId",e.formModel.readonly),disabled:e.$FormCheck("collectionId",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Collection")})},model:{value:e.formData.collectionId,callback:function(t){e.$set(e.formData,"collectionId",t)},expression:"formData.collectionId"}},e._l(e.formTemp.collection,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),3!==e.formData.isPay?a("FormItem",{attrs:{label:e.$t("dt.form.PayMoney"),prop:"payMoney"}},[a("InputNumber",{attrs:{max:e.formData.money,min:0,readonly:e.$FormCheck("payMoney",e.formModel.readonly),clearable:!e.$FormCheck("payMoney",e.formModel.readonly)},model:{value:e.formData.payMoney,callback:function(t){e.$set(e.formData,"payMoney",t)},expression:"formData.payMoney"}}),a("span",[e._v(e._s(e.$t("dt.base.unit")))])],1):e._e()],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("userId",e.formModel.hide),expression:"!$FormCheck('userId', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.base.Salesman"),prop:"userId"}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.base.Salesman")}),route:"UserAdd",type:2,api:e.$Model.Users,column:[{username:e.$t("dt.form.Username")},{phone:e.$t("dt.base.telPhone")}],attrs:{label:"username",value:"id"},readonly:e.$FormCheck("userId",e.formModel.readonly),clearable:!e.$FormCheck("userId",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.base.Salesman")})},model:{value:e.formData.userId,callback:function(t){e.$set(e.formData,"userId",t)},expression:"formData.userId"}})],1)],1),a("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("dividendId",e.formModel.hide),expression:"!$FormCheck('dividendId', formModel.hide)"}],attrs:{label:e.$t("dt.form.DividendProgram"),prop:"dividendId"}},[a("Select",{attrs:{readonly:e.$FormCheck("dividendId",e.formModel.readonly),disabled:e.$FormCheck("dividendId",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.DividendProgram")})},on:{"on-change":e.handleDividendChange},model:{value:e.formData.dividendId,callback:function(t){e.$set(e.formData,"dividendId",t)},expression:"formData.dividendId"}},e._l(e.formTemp.dividendList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("target",e.formModel.hide)&&2===e.currentDividend.target,expression:"!$FormCheck('target', formModel.hide) && currentDividend.target === 2"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:8}},[a("FormItem",{attrs:{label:e.$t("dt.form.ProgramTarget"),prop:"target"}},[a("RadioGroup",{attrs:{type:"button",readonly:e.$FormCheck("target",e.formModel.readonly),disabled:e.$FormCheck("target",e.formModel.readonly)},on:{"on-change":e.handleTargetChange},model:{value:e.formData.target,callback:function(t){e.$set(e.formData,"target",t)},expression:"formData.target"}},e._l(e.$options.filters.dividendTarget([]),(function(t){return a("Radio",{key:t.value,attrs:{disabled:e.$FormCheck("target",e.formModel.readonly),label:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("targetUser",e.formModel.hide)&&2===e.formData.target,expression:"!$FormCheck('targetUser', formModel.hide) && formData.target === 2"}],staticClass:"input-item",attrs:{xs:24,sm:24,md:24,lg:24,xl:22,xxl:22}},[a("FormItem",{attrs:{prop:"targetUser"}},[a("ListSelectModal",{attrs:{title:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.ProgramTarget")}),api:e.$Model.Users,column:[{username:e.$t("dt.form.Username")},{phone:e.$t("dt.base.telPhone")},{startTime:e.$t("dt.base.Condition"),filters:{name:"formatSatisfy",value:e.currentDividend.inJobTime?864e5*e.currentDividend.inJobTime:0}}],attrs:{label:"username",value:"id"},filter:{branchs:{id:e.$UserInfo.bid}},readonly:e.$FormCheck("targetUser",e.formModel.readonly),clearable:!e.$FormCheck("targetUser",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.ProgramTarget")})},model:{value:e.formData.targetUser,callback:function(t){e.$set(e.formData,"targetUser",t)},expression:"formData.targetUser"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("status",e.formModel.hide),expression:"!$FormCheck('status', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:e.$t("dt.form.OrderStatus"),prop:"status"}},[a("Select",{attrs:{readonly:e.$FormCheck("status",e.formModel.readonly),disabled:e.$FormCheck("status",e.formModel.readonly),placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.OrderStatus")})},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},e._l(e.$options.filters.orderStatus([]),(function(t){return a("Option",{key:t.value,attrs:{disabled:!e.id&&5===t.value||void 0===e.id&&6===t.value,value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),a("Col",{staticClass:"input-item",attrs:{span:24}},[a("FormItem",{attrs:{label:e.$t("dt.form.Product")}},[a("div",{staticClass:"drag-table"},[a("Col",{staticClass:"table-layer",attrs:{xs:24,sm:24,md:24,lg:24,xl:22,xxl:22}},[e.isReadonly?e._e():a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.open=!0}}},[a("Icon",{attrs:{type:"md-add"}}),e._v(e._s(e.$t("dt.form.ProductAdd")))],1),e.formTemp.data.length>0?a("Table",{ref:"selection",staticClass:"table-body",attrs:{border:"",loading:e.loading&&e.isMethodList,"max-height":500,"show-summary":!0,columns:e.columns,"summary-method":e.handleTableSummary,"span-method":e.handleSpan,data:e.formTemp.data}}):e._e()],1)],1)])],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",[!e.isReadonly&&e.$isHasMenuAuth("admin.SalesOrderAdd")||!e.isReadonly&&e.$isHasMenuAuth("admin.SalesOrderEdit")?a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSumbitCheck}},[e._v(" "+e._s(e.btnTitle)+" ")]):e.$isHasMenuAuth("admin.SalesOrderEdit")&&1===e.formData.status?a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleCheckHabitType({name:"admin.SalesOrderEdit",params:{id:e.id}})}}},[e._v(" "+e._s(e.$t("dt.form.edit"))+" ")]):e._e(),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleRouteGoBack("admin.SalesOrderList")}}},[e._v(e._s(e.$t("dt.base.back")))])],1)],1)],1)],1)],1),a("Modal",{attrs:{width:e.modelWidth,"mask-closable":!1,"class-name":"modal-layer"},on:{"on-ok":e.handleProductModelOnOk},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h2",[e._v(e._s(e.$t("dt.form.ProductAdd")))])]),a("div",{staticClass:"connent-layer"},[a("div",{staticClass:"nav-group"},[a("div",{staticClass:"filter-layer"},[a("div",{staticClass:"filter-item"},[a("span",[e._v(e._s(e.$t("dt.form.ProductName"))+"：")]),a("Input",{staticClass:"search-input",attrs:{search:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.ProductName")})},on:{"on-enter":e.handleFilterChange,"on-search":e.handleFilterChange},model:{value:e.filters.product.name_like,callback:function(t){e.$set(e.filters.product,"name_like",t)},expression:"filters.product.name_like"}})],1),a("div",{staticClass:"filter-item"},[a("span",[e._v(e._s(e.$t("dt.form.ProductCode"))+"：")]),a("Input",{staticClass:"search-input",attrs:{search:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.ProductCode")})},on:{"on-enter":e.handleFilterChange,"on-search":e.handleFilterChange},model:{value:e.filters.product.productCode_like,callback:function(t){e.$set(e.filters.product,"productCode_like",t)},expression:"filters.product.productCode_like"}})],1),a("div",{staticClass:"filter-item"},[a("span",[e._v(e._s(e.$t("dt.form.SkuCode"))+"：")]),a("Input",{staticClass:"search-input",attrs:{search:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.SkuCode")})},on:{"on-enter":e.handleFilterChange,"on-search":e.handleFilterChange},model:{value:e.filters.sku.skuCode_like,callback:function(t){e.$set(e.filters.sku,"skuCode_like",t)},expression:"filters.sku.skuCode_like"}})],1),a("div",{staticClass:"filter-item"},[a("span",[e._v(e._s(e.$t("dt.form.Warehouse"))+"：")]),a("Select",{attrs:{clearable:"",placeholder:e.$t("dt.base.pleaseSelect",{label:e.$t("dt.form.Warehouse")})},on:{"on-change":e.handleFilterChange},model:{value:e.filters.warehouseId,callback:function(t){e.$set(e.filters,"warehouseId",t)},expression:"filters.warehouseId"}},e._l(e.formTemp.warehouseList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)])]),a("div",{staticClass:"product-layer"},[a("div",{staticClass:"tree-layer",attrs:{slot:"left"},slot:"left"},[a("span",[e._v(e._s(e.$t("dt.form.ProductCategory")))]),a("Tree",{attrs:{data:e.formTemp.categoryList},on:{"on-select-change":e.handleTreeSelectChange}})],1),a("div",{staticClass:"table-layout",attrs:{slot:"right"},slot:"right"},[a("Table",{ref:"productTable",attrs:{border:"",loading:e.loading&&e.isMethodList,"highlight-row":!0,columns:e.colData,data:e.formTemp.productData},on:{"on-select-cancel":e.handleTableOnSelectCancel,"on-selection-change":e.handleTableSelectionChange}})],1)])]),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"left"},[a("div",{staticClass:"page-list"},[a("Page",{attrs:{"show-total":"","show-sizer":"","show-elevator":"",total:e.formTemp.total,current:e.formTemp.current_page,"page-size-opts":e.formTemp.pageSizeOpts,"page-size":e.formTemp.per_page},on:{"on-page-size-change":e.handleOnPageSizeChange,"on-change":e.handleChangePage}})],1)]),a("div",{staticClass:"right"},[a("Button",{on:{click:function(t){e.open=!1}}},[e._v(e._s(e.$t("dt.form.cancel")))]),e.formTemp.productData.length>0?a("Button",{attrs:{type:"primary"},on:{click:e.handleProductModelOnOk}},[e._v(e._s(e.$t("dt.base.confirm")))]):e._e()],1)])])],1)},o=[],i=a("212c"),n=i["a"],s=(a("269a"),a("c701")),l=Object(s["a"])(n,r,o,!1,null,"234afb08",null);t["a"]=l.exports}}]);