(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-424f41e0"],{"0235":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"log-list-page"},[a("div",{staticClass:"wrapper"},[a("div",{staticClass:"controller"},[a("Row",{staticClass:"filter-group",class:{active:t.rowToggle},attrs:{type:"flex",gutter:20}},[a("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{staticClass:"child-title",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$t("dt.form.LogName"))+"：")])]),a("Col",{attrs:{span:"16"}},[a("Input",{attrs:{search:"",placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.LogName")})},on:{"on-enter":t.handleFilterChange,"on-search":t.handleFilterChange},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1)],1),a("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{staticClass:"child-title",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$t("dt.form.status"))+"：")])]),a("Col",{attrs:{span:"16"}},[a("status",{on:{swtichStatus:t.handleFilterChange}})],1)],1)],1),a("Col",{staticClass:"filter-item",attrs:{xs:24,sm:12,md:8,lg:8,xl:6,xxl:6}},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{staticClass:"child-title",attrs:{span:"8"}},[a("span",[t._v(t._s(t.$t("dt.base.sort"))+"：")])]),a("Col",{attrs:{span:"16"}},[a("sorts",{on:{swtichSorts:t.handleFilterChange}})],1)],1)],1),a("button",{staticClass:"row-toggle",attrs:{type:"button"},on:{click:function(e){return t.$store.commit("spinShow/rowToggle")}}},[t.rowToggle?a("Icon",{attrs:{type:"ios-arrow-up",size:"25",color:"#999"}}):a("Icon",{attrs:{type:"ios-arrow-down",size:"25",color:"#999"}})],1)],1),a("div",{staticClass:"btn-group"},[a("div",{staticClass:"left"},[t.$isHasMenuAuth("admin.LogDelete")?a("Button",{attrs:{type:"error"},on:{click:function(e){return t.handleAsync(t.tableMultipleSelect)}}},[a("Icon",{attrs:{type:"md-trash"}}),t._v(t._s(t.$t("dt.form.deleteAll"))+" ")],1):t._e(),t.$isHasMenuAuth("admin.LogEdit")?a("Button",{attrs:{type:"success"},on:{click:function(e){return t.handleAsyncSavaAll(t.tableMultipleSelect)}}},[a("Icon",{attrs:{type:"md-create"}}),t._v(t._s(t.$t("dt.form.saveAll"))+" ")],1):t._e()],1),a("div",{staticClass:"right"},[t.$isHasMenuAuth("admin.LogExport")?a("Button",{attrs:{type:"warning"},on:{click:t.handleAsyncExport}},[a("Icon",{attrs:{type:"md-cloud-download"}}),t._v(t._s(t.$t("dt.form.export"))+"Excel ")],1):t._e()],1)]),a("div",{staticClass:"table"},[a("Table",{ref:"selection",attrs:{border:"",loading:t.loading&&t.isMethodList,columns:t.columns,data:t.formTemp.data},on:{"on-select-cancel":t.handleTableOnSelectCancel,"on-selection-change":t.handleTableSelectionChange}})],1),a("div",{staticClass:"page-list"},[a("Page",{attrs:{"show-total":"","show-sizer":"","show-elevator":"",total:t.formTemp.total,current:t.formTemp.current_page,"page-size-opts":t.formTemp.pageSizeOpts,"page-size":t.formTemp.per_page},on:{"on-page-size-change":t.handleOnPageSizeChange,"on-change":t.handleChangePage}})],1)],1)]),a("Modal",{attrs:{transfer:!1,"footer-hide":!0,"mask-closable":!1,styles:t.modalStyle},on:{"on-cancel":t.handleModalClose},model:{value:t.status.rrweb,callback:function(e){t.$set(t.status,"rrweb",e)},expression:"status.rrweb"}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"}),a("div",{staticClass:"rrweb-layer"},[t.formTemp.id?a("rrweb-video",{attrs:{id:t.formTemp.id,view:t.formTemp.view,mark:t.formTemp.mark,events:t.formTemp.events}}):t._e()],1)])],1)},i=[],n=(a("1b8a"),a("d211")),r=a("b8f9"),o=a("efa4"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rrweb-video-page"},[a("div",{staticClass:"video-layer"},[a("div",{ref:t.name,staticClass:"video",on:{click:function(e){e.stopPropagation(),t.isPlay?t.handlePauseVideo():t.handleInitVideo()}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isPlay,expression:"!isPlay"}],staticClass:"video-icon",on:{click:function(e){return e.stopPropagation(),t.handleInitVideo()}}},[a("Icon",{attrs:{size:100,type:"md-play"}})],1)]),a("div",{staticClass:"foot-layer"},[a("div",{staticClass:"timer-layer"},[a("span",[t._v(t._s(t._f("videoDate")(t.currentTime)))]),a("div",{staticClass:"timer"},[a("div",{staticClass:"timer-body",style:{width:t.currentTime/t.totalTime*100+"%"}})]),a("span",[t._v(t._s(t._f("videoDate")(t.totalTime)))])]),a("div",{staticClass:"controls"},[a("div",{staticClass:"play"},[t.isPlay?a("Icon",{attrs:{size:40,type:"md-pause"},on:{click:function(e){return t.handlePauseVideo()}}}):a("Icon",{attrs:{size:40,type:"md-play"},on:{click:function(e){return t.handleInitVideo()}}})],1),a("div",{staticClass:"speed-layer"},[a("ButtonGroup",t._l(t.formTemp.speed,(function(e,s){return a("Button",{key:s,attrs:{type:t.formData.speed===e.value?"primary":""},on:{click:function(a){t.formData.speed=e.value}}},[t._v(" "+t._s(e.label)+" ")])})),1)],1),a("div",{staticClass:"switch-group"},[a("div",{staticClass:"item"},[a("span",[t._v("无用户操作：")]),a("i-switch",{attrs:{size:"large"},model:{value:t.formData.skipInactive,callback:function(e){t.$set(t.formData,"skipInactive",e)},expression:"formData.skipInactive"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("dt.status.yes")))]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("dt.status.no")))])])],1),a("div",{staticClass:"item"},[a("span",[t._v("警告信息：")]),a("i-switch",{attrs:{size:"large"},model:{value:t.formData.showWarning,callback:function(e){t.$set(t.formData,"showWarning",e)},expression:"formData.showWarning"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("dt.status.no")))]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("dt.status.no")))])])],1),a("div",{staticClass:"item"},[a("span",[t._v("debug信息：")]),a("i-switch",{attrs:{size:"large"},model:{value:t.formData.showDebug,callback:function(e){t.$set(t.formData,"showDebug",e)},expression:"formData.showDebug"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("dt.status.no")))]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("dt.status.no")))])])],1)]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"item"},[a("span",[t._v("查看：")]),a("i-switch",{attrs:{size:"large","true-value":2,"false-value":1},on:{"on-change":t.handleSwitchChange},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("dt.status.yes")))]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("dt.status.no")))])])],1),a("div",{staticClass:"item"},[a("span",[t._v("标记：")]),a("i-switch",{attrs:{size:"large","true-value":2,"false-value":1},model:{value:t.mark,callback:function(e){t.mark=e},expression:"mark"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("dt.status.no")))]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("dt.status.no")))])])],1)])])])])])},d=[],c=(a("5c4c"),a("4798"),a("1f8b")),h={name:"RrwebVideo",data:function(){return{timer:null,isPlay:!1,formData:{speed:1,skipInactive:!1,showWarning:!1,showDebug:!1,remark:null},formTemp:{speed:[{label:"1 倍",value:1},{label:"2 倍",value:2},{label:"4 倍",value:4},{label:"8 倍",value:8}]},name:"replayer_".concat((new Date).getTime()),replayer:null,currentTime:0,totalTime:0}},props:{id:{type:String,default:function(){return""}},view:{type:Number,default:function(){return 1}},mark:{type:Number,default:function(){return 1}},events:{type:String,default:function(){return""}}},computed:{},mounted:function(){},watch:{events:function(t){null===t&&this.replayer?this.handleResetVideo():this.handleInitVideo()}},destroyed:function(){this.timer&&this.handleResetVideo()},methods:{handleInitVideo:function(){if(this.replayer)this.handlePlayVideo();else if(!r["a"].isEmpty(this.events)){var t=[];try{t=JSON.parse(this.events)}catch(a){t=[]}var e={speed:this.formData.speed,root:this.$refs[this.name],loadTimeout:0,skipInactive:this.formData.skipInactive,showWarning:this.formData.showWarning,showDebug:this.formData.showDebug};this.replayer=new c["Replayer"](t,e),this.replayer&&(this.totalTime=parseInt(this.replayer.getMetaData().totalTime/1e3)||0,this.handlePlayVideo())}},handlePlayVideo:function(){this.replayer&&this.replayer.play(),this.isPlay=!0,this.handleGetCurrentTime()},handlePauseVideo:function(){this.timer&&clearTimeout(this.timer),this.replayer&&this.replayer.pause(),this.isPlay=!1},handleResumeVideo:function(){this.replayer&&this.replayer.resume(),this.currentTime=0,this.totalTime=0,this.isPlay=!0},handleResetVideo:function(){var t=this;this.timer&&clearTimeout(this.timer),this.replayer&&(this.handlePauseVideo(),this.currentTime=0,this.totalTime=0,this.isPlay=!1,this.replayer=null,setTimeout((function(){t.$refs[t.name].innerHTML=null}),100))},handleGetCurrentTime:function(){var t=this;this.currentTime=parseInt(this.replayer.getCurrentTime()/1e3),this.currentTime<0&&(this.currentTime=0),this.replayer&&this.currentTime<this.totalTime?this.timer=setTimeout((function(){t.handleGetCurrentTime()}),1e3):(this.isPlay=!1,clearTimeout(this.timer))},handleSwitchChange:function(){var t=this,e={id:this.id,data:{view:this.view,mark:this.mark,remark:this.formData.remark}};this.$Http.Post({mutation:this.$Model.LogEdit,variables:e}).then((function(){t.$Message.success(t.$t("dt.toast.saveOk"))}))}}},m=h,p=(a("5141"),a("c701")),u=Object(p["a"])(m,l,d,!1,null,"7e6c8da4",null),f=u.exports,v={name:"LogList",mixins:[o["a"]],data:function(){return{status:{rrweb:!1},formTemp:{id:null,view:null,mark:null,events:null},modalStyle:{}}},components:{RrwebVideo:f},computed:{columns:function(){var t=this;return[{type:"selection",width:60,align:"center",fixed:"left"},{title:this.$t("dt.form.index"),type:"index",width:80,align:"center"},{title:this.$t("dt.form.LogType"),key:"tye",minWidth:200,align:"center",ellipsis:!0,tooltip:!0,render:function(e,a){return e(t.$isHasMenuAuth("admin.LogDetail")?"router-link":"span",{props:{to:{name:"admin.LogDetail",params:{id:a.row.id}}}},a.row.tye)}},{title:this.$t("dt.base.level"),key:"tye",width:80,align:"center",sortable:!0,render:function(e,a){var s=t.$options.filters.logType(a.row.tye),i="#666";return 3===s?i="#2db7f5":2===s?i="#ff9900":1===s&&(i="#ed4014"),e("span",{style:{color:i}},t.$options.filters.errorType(s))}},{title:this.$t("dt.form.LogDetail"),key:"message",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.form.routeLink"),key:"path",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.form.MerchantId"),key:"mid",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.form.BranchId"),key:"bid",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.form.UserId"),key:"uid",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.base.remark"),key:"remark",minWidth:200,align:"center",tooltip:!0},{title:this.$t("dt.form.status"),key:"state",width:100,align:"center",render:function(e,a){return e("i-switch",{props:{value:r["a"].isNumber(a.row.state)?1===a.row.state:a.row.state,size:"large",loading:a.row.loading,disabled:!t.$isHasMenuAuth("admin.LogEdit")||(a.row.disabled||!1)},on:{"on-change":function(e){t.handleUpdateStatus(a.row,e)}}},[e("span",{slot:"open"},t.$t("dt.status.open")),e("span",{slot:"close"},t.$t("dt.status.close"))])}},{title:this.$t("dt.form.deletedAt"),key:"deletedAt",width:170,align:"center",sortable:!0,render:function(e,a){return e("span",t.$options.filters.formatTime(a.row.deletedAt))}},{title:this.$t("dt.form.updatedAt"),key:"updatedAt",width:170,align:"center",sortable:!0,render:function(e,a){return e("span",t.$options.filters.formatTime(a.row.updatedAt))}},{title:this.$t("dt.form.createdAt"),key:"createdAt",width:170,align:"center",sortable:!0,render:function(e,a){return e("span",t.$options.filters.formatTime(a.row.createdAt))}},{title:this.$t("dt.base.review",{label:null}),key:"view",width:80,align:"center",fixed:"right",render:function(e,a){return e("span",t.$options.filters.noOrYes(1*a.row.view))}},{title:this.$t("dt.base.mark"),key:"mark",width:80,align:"center",fixed:"right",render:function(e,a){return e("span",t.$options.filters.noOrYes(1*a.row.mark))}},{title:this.$t("dt.base.play"),width:80,align:"center",fixed:"right",render:function(e,a){return e("Button",{props:{type:"warning",size:"small"},on:{click:function(){t.handleRrwebPlay(a.row)}}},t.$t("dt.base.play"))}},{title:this.$t("dt.form.action"),key:"action",width:200,align:"center",fixed:"right",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCheckHabitType({name:"admin.LogDetail",params:{id:a.row.id}})}}},t.$t("dt.form.detail")),e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCheckHabitType({name:"admin.LogEdit",params:{id:a.row.id}})}}},t.$t("dt.form.edit")),e("Button",{props:{type:r["a"].isEmpty(a.row.deletedAt)?"error":"success",size:"small"},on:{click:function(){r["a"].isEmpty(a.row.deletedAt)?t.handleAsync(a):t.handleRecoveryAsync(a)}}},r["a"].isEmpty(a.row.deletedAt)?t.$t("dt.form.delete"):t.$t("dt.form.recovery"))])}}]}},created:function(){this.handleList()},mounted:function(){},watch:{},filters:{},methods:{handleList:function(){var t=this,e=this.handleInitFields(this.columns,["video.id","video.logTxt"]),a=this.variables;this.$Http.Post({mutation:this.$Model.Logs,variables:a,fields:e}).then((function(e){var a=e.data;t.formTemp=Object(n["a"])(Object(n["a"])({},t.formTemp),a),t.sortData(t.formTemp.data)}))},sortData:function(){var t=this;r["a"].each(this.formTemp.data,(function(e,a){e.index=(t.formTemp.current_page-1)*t.formTemp.per_page+a+1,e.loading=!1}))},handleRowItemSave:function(t,e){r["a"].isEmpty(t)||this.handleOnRecovery({api:this.$Model.LogEdit,item:t,type:2},e)},handleUpdateStatus:function(t,e){this.handleUpdateStatusFunc({api:this.$Model.LogEdit,item:t,value:e})},handleRecovery:function(t,e){r["a"].isEmpty(t)||this.handleOnRecovery({api:this.$Model.LogsRecovery,item:t},e)},handleDelete:function(t){r["a"].isEmpty(t.id)||r["a"].isEmpty(t.index)||this.handleOnDelete({api:this.$Model.LogsDelete,item:t})},handleRrwebPlay:function(t){if(t.logTxt){this.formTemp.id=t.id,this.formTemp.view=t.view,this.formTemp.mark=t.mark,this.formTemp.events=t.logTxt,this.status.rrweb=!0;var e=[];try{e=JSON.parse(this.formTemp.events)}catch(s){e=[]}var a=e.find((function(t){return 4===t.type}));r["a"].isEmpty(a)||(this.modalStyle={top:"0px",width:"".concat(a.data.width,"px"),height:"".concat(a.data.height,"px")})}},handleModalClose:function(){this.formTemp.id=null,this.formTemp.events=null}}},y=v,g=(a("57b7"),Object(p["a"])(y,s,i,!1,null,"33726258",null));e["default"]=g.exports},5141:function(t,e,a){"use strict";a("a1a0")},"57b7":function(t,e,a){"use strict";a("a9c2")},a1a0:function(t,e,a){},a9c2:function(t,e,a){}}]);