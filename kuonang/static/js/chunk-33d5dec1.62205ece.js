(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33d5dec1"],{"04d5":function(e,t,r){},"31ae":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-content-layer"},[r("Tabs",{staticClass:"tabs",attrs:{type:"card"}},[r("TabPane",{attrs:{label:e.tabName[0]}},[r("Form",{ref:"form",staticClass:"form-page",attrs:{"label-position":"right","label-width":100,model:e.formData,rules:e.ruleInline}},[r("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("orderNo",e.formModel.hide),expression:"!$FormCheck('orderNo', formModel.hide)"}],attrs:{label:e.$t("dt.form.OrderNo"),prop:"orderNo"}},[r("Input",{attrs:{readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.OrderName")})},model:{value:e.formData.orderNo,callback:function(t){e.$set(e.formData,"orderNo",t)},expression:"formData.orderNo"}})],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("name",e.formModel.hide),expression:"!$FormCheck('name', formModel.hide)"}],attrs:{label:e.$t("dt.form.OrderName"),prop:"name"}},[r("Input",{attrs:{readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.OrderName")})},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1),r("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("dividend",e.formModel.hide),expression:"!$FormCheck('dividend', formModel.hide)"}],attrs:{label:e.$t("dt.form.DividendProgram")}},[r("Input",{attrs:{readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.DividendProgram")})},model:{value:e.formData.dividend.name,callback:function(t){e.$set(e.formData.dividend,"name",t)},expression:"formData.dividend.name"}})],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("salesMoney",e.formModel.hide),expression:"!$FormCheck('salesMoney', formModel.hide)"}],attrs:{label:e.$t("dt.form.OrderMoney"),prop:"salesMoney"}},[r("Input",{attrs:{value:e.$options.filters.money(e.formData.salesMoney),readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.OrderMoney")})}}),r("span",[e._v(e._s(e.$t("dt.base.unit")))])],1)],1),r("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("money",e.formModel.hide),expression:"!$FormCheck('money', formModel.hide)"}],attrs:{label:e.$t("dt.form.CommissionMoney"),prop:"money"}},[r("Input",{attrs:{value:e.$options.filters.money(e.formData.money),readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.CommissionMoney")})}}),r("span",[e._v(e._s(e.$t("dt.base.unit")))])],1),r("FormItem",{attrs:{label:e.$t("dt.form.OtherDividend")}},[r("Input",{attrs:{value:e.$options.filters.money(e.formTemp.otherDividend),readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.OtherDividend")})}}),r("span",[e._v(e._s(e.$t("dt.base.unit")))])],1)],1),r("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{attrs:{label:e.$t("dt.form.OrderDividend")}},[r("Input",{attrs:{value:e.$options.filters.money(e.formData.orderMoney),readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.OrderDividend")})}}),r("span",[e._v(e._s(e.$t("dt.base.unit")))])],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("surpluMoney",e.formModel.hide),expression:"!$FormCheck('surpluMoney', formModel.hide)"}],attrs:{label:e.$t("dt.form.SurpluMoney"),prop:"surpluMoney"}},[r("Input",{attrs:{value:e.$options.filters.money(e.formData.surpluMoney),readonly:"",placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.SurpluMoney")})}}),r("span",[e._v(e._s(e.$t("dt.base.unit")))])],1)],1),r("Col",{staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("status",e.formModel.hide),expression:"!$FormCheck('status', formModel.hide)"}],attrs:{label:e.$t("dt.form.ProgramStatus")+":",prop:"status"}},[r("RadioGroup",{attrs:{type:"button"},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},e._l(e.$options.filters.dividendOrderStatus([]),(function(t){return r("Radio",{key:t.value,attrs:{disabled:"",label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("tye",e.formModel.hide),expression:"!$FormCheck('tye', formModel.hide)"}],attrs:{label:e.$t("dt.form.ProgramMode")+":",prop:"tye"}},[r("RadioGroup",{attrs:{type:"button"},model:{value:e.formData.tye,callback:function(t){e.$set(e.formData,"tye",t)},expression:"formData.tye"}},e._l(e.$options.filters.dividendType([]),(function(t){return r("Radio",{key:t.value,attrs:{disabled:"",label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),r("Col",{directives:[{name:"show",rawName:"v-show",value:!e.$FormCheck("remark",e.formModel.hide),expression:"!$FormCheck('remark', formModel.hide)"}],staticClass:"input-item form-item-flex",attrs:{xs:24,sm:24,md:20,lg:16,xl:14,xxl:12}},[r("FormItem",{attrs:{label:e.$t("dt.base.remark"),prop:"remark"}},[r("Input",{attrs:{readonly:e.$FormCheck("remark",e.formModel.readonly),clearable:!e.$FormCheck("remark",e.formModel.readonly),maxlength:"255","show-word-limit":"",type:"textarea",rows:4,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.base.remark")})},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),r("Col",{staticClass:"input-item",attrs:{span:20}},[r("FormItem",{attrs:{label:e.$t("dt.form.CommissionPeopleNumber")}},[r("Table",{ref:"selection",staticClass:"table-body",attrs:{border:"",loading:e.loading&&e.isMethodList,"max-height":500,columns:e.columns,"span-method":e.handleTableSpan,data:e.formTemp.data}})],1)],1),r("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[r("FormItem",[!e.isReadonly&&e.$isHasMenuAuth("admin.CommissionAdd")||!e.isReadonly&&e.$isHasMenuAuth("admin.CommissionEdit")?r("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSumbitCheck}},[e._v(" "+e._s(e.btnTitle)+" ")]):e.$isHasMenuAuth("admin.CommissionEdit")?r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.handleCheckHabitType({name:"admin.CommissionEdit",params:{id:e.id}})}}},[e._v(" "+e._s(e.$t("dt.form.edit"))+" ")]):e._e(),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleRouteGoBack("admin.CommissionList")}}},[e._v(e._s(e.$t("dt.base.back")))])],1)],1)],1)],1)],1)],1)},o=[],n=(r("2d38"),r("2c78"),r("9953"),r("64fe"),r("02bf"),r("a39b"),r("90d4"),r("5c4c"),r("4037"),r("d211")),i=r("b8f9"),s=r("4ec25"),d={name:"ProgramModel",mixins:[s["a"]],data:function(){var e=this;return{formTemp:{orderDividend:0,otherDividend:0,data:[]},formData:{orderMoney:0,surpluMoney:0,dividend:{}},columns:[{title:this.$t("dt.form.index"),type:"index",width:80,align:"center"},{title:this.$t("dt.form.UserName"),align:"center",render:function(e,t){var r=t.row.user||{};return e("span",r.username)}},{title:this.$t("dt.form.role"),align:"center",render:function(e,t){var r=t.row.roles||[];return e("span",r.map((function(e){return e.name})).join())}},{title:this.$t("dt.form.DividendMoney"),key:"money",align:"center",render:function(t,r){return t("span","".concat(e.$options.filters.money(r.row.money)," ").concat(e.$t("dt.base.unit")))}},{title:"".concat(this.$t("dt.form.Dividend")).concat(this.$t("dt.form.Ratio")),key:"ratio",align:"center",render:function(t,r){var a=r.row.ratio;if(2===r.row.other)return t("span",e.$t("dt.form.OtherDividend"));var o=e.formTemp.data.filter((function(e,t){return t!==r.index})).map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0);return t("div",[t("InputNumber",{props:{value:a,size:"small",min:0,max:100-o,step:.1,clearable:!0,readonly:e.isReadonly,placeholder:e.$t("dt.base.pleaseInput",{label:e.$t("dt.form.Ratio")})},on:{input:function(t){e.handleCheckMoney(t,r.index)}}}),t("span",{style:{marginLeft:"5px"}},"%")])}},{title:this.$t("dt.form.Surplus"),width:100,align:"center",render:function(t,r){if(2===r.row.other)return t("span",e.$t("dt.base.Nothing"));var a=e.formTemp.data.filter((function(e){return 1===e.other})).map((function(e){return+e.ratio})).reduce((function(e,t){return e+t}),0);return t("span","".concat(e.$options.filters.toFixed(100-a)," %"))}},{title:this.$t("dt.form.action"),key:"action",width:100,align:"center",render:function(t,r){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.formTemp.data.splice(r.index,1)}}},e.$t("dt.form.delete"))}}],ruleInline:{weight:[{required:!0,type:"number",message:this.$t("dt.form.weightPlaceholder"),trigger:"blur"},{validator:this.$Validator("number",this.$t("dt.form.weightPlaceholder")),trigger:"blur"}]}}},computed:{},created:function(){i["a"].isEmpty(this.id)||this.handleDetail()},mounted:function(){window.aa=this},components:{},watch:{},methods:{handleDetail:function(){var e=this;this.$Http.Post({mutation:this.$Model.DividendOrderDetail,variables:{id:this.id},fields:["id","name","orderNo","salesMoney","money","orderMoney","surpluMoney","status","tye","remark","dividend.id","dividend.name","salesOrder.id","salesOrder.orderNo","child.id","child.money","child.ratio","child.other","child.user.id","child.user.username","child.user.roles.id","child.user.roles.name","child.user.roles.branchId"]},(function(){e.$router.push({name:"admin.CommissionList"})})).then((function(t){var r=t.data;r.state=1===r.state||!0===r.state,i["a"].sortBy(r.child,{key:"other",type:"max"}),i["a"].each(r.child,(function(t){var r=t.user||{},a=r.roles.filter((function(t){return t.branchId===e.$UserInfo.bid}));t.roles=a||[],1===t.other?e.formTemp.orderDividend+=t.money:e.formTemp.otherDividend+=t.money})),e.formTemp.data=r.child||[],e.formData=Object(n["a"])(Object(n["a"])({},e.formData),r)}))},handleCheckMoney:function(e,t){var r=this;this.formTemp.data[t].ratio=e,this.formTemp.data[t].money=100*this.$options.filters.money(this.formTemp.orderDividend*(e/100)),this.formData.orderMoney=this.formTemp.data.filter((function(e){return 1===e.other})).map((function(e){return 100*r.$options.filters.money(e.money)})).reduce((function(e,t){return e+t}),0),this.formData.surpluMoney=this.formData.money-this.formTemp.otherDividend-this.formData.orderMoney},handleTableSpan:function(e){var t=this,r=e.rowIndex,a=e.columnIndex;if(5===a){var o=this.formTemp.data.filter((function(e){return 2===e.other})).map((function(e){return t.formTemp.data.findIndex((function(t){return t.id===e.id}))}));if(o.length>0){if(r===o[0])return{rowspan:o.length,colspan:1};if(r===o[o.length-1])return{rowspan:0,colspan:0}}var n=this.formTemp.data.filter((function(e){return 1===e.other})).map((function(e){return t.formTemp.data.findIndex((function(t){return t.id===e.id}))}));if(n.length>0){if(r===n[0])return{rowspan:n.length,colspan:1};if(r===n[n.length-1])return{rowspan:0,colspan:0}}}},handleSumbitCheck:function(){var e=Object(n["a"])({},this.formData);if(e.child.length<=0)this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:"".concat(this.$t("dt.base.CommissionPeopleNumber")).concat(this.$t("dt.api.notEmpty"))});else{var t=[];i["a"].each(e.child,(function(e){t.push({id:e.id,money:e.money,ratio:e.ratio})})),e.child=t,this.handleSumbit(e)}}}},l=d,m=(r("f1ec"),r("c701")),u=Object(m["a"])(l,a,o,!1,null,"6ea7f4c6",null);t["a"]=u.exports},"4ec25":function(e,t,r){"use strict";r("6a61");var a=r("2e91"),o=r("d211"),n=r("5880"),i=r("b8f9"),s={data:function(){return{id:null,isReadonly:!1,formData:{branchId:this.$UserInfo.bid,state:!0,weight:1}}},props:{formData_bak:{type:Object,default:function(){return{}}},formModel:{type:Object,default:function(){return{}}},btnTitle:{type:String,default:""},tabName:{type:Array,default:function(){return[null]}}},created:function(){this.id=this.$GetParamsId(this),this.$FormCheck("*",this.formModel.readonly)&&(this.isReadonly=!0,this.ruleInline={})},computed:Object(o["a"])({},Object(n["mapState"])("base",{loading:function(e){return e.loading},isMethodList:function(e){return e.isMethodList}})),methods:{handleEmitData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData;this.$store.commit("popupModel/pageModal",{pageModal:!1}),this.$emit("formDataSubmit",{data:e})},handleFilterBranchChange:function(e){i["a"].isEmpty(e)||(this.formData.branchId=e)},handleSumbit:function(){var e=arguments,t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,n,s,d,l,m;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:t.formData,n=e.length>1&&void 0!==e[1]?e[1]:"form",o.state=!0===o.state||1*o.state===1?1:2,s=!0,d=!1,!i["a"].isString(n)){r.next=16;break}if(t.$refs[n]){r.next=11;break}s=!1,d=!0,r.next=14;break;case 11:return r.next=13,t.$refs[n].validate((function(e){return e}));case 13:d=r.sent;case 14:r.next=22;break;case 16:if(!i["a"].isArray(n)){r.next=22;break}return l=!0,i["a"].each(n,function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs[r]?t.$refs[r].validate((function(e){!1===e&&!0===l&&(l=!1)})):(s=!1,l=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.next=21,l;case 21:d=r.sent;case 22:if(!1!==s||!0!==d){r.next=25;break}return t.handleEmitData(o),r.abrupt("return");case 25:if(!1!==d){r.next=28;break}return t.$Message.error(t.$t("dt.form.checkFormComplete")),r.abrupt("return");case 28:m=t.$store.state.popupModel.pageModal,!0===m&&t.$store.commit("popupModel/loadData",{loadData:!0}),t.handleEmitData(o);case 31:case"end":return r.stop()}}),r)})))()}}};t["a"]=s},"4f16":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"Commission-edit-page"},[r("div",{staticClass:"wrapper"},[r("div",{staticClass:"controller"},[r("form-model",{attrs:{formModel:e.formModel,tabName:[e.$t("dt.form.CommissionEdit")],btnTitle:e.$t("dt.base.save")},on:{formDataSubmit:e.handleFormDataSubmit}})],1)])])},o=[],n=r("d211"),i=(r("6a61"),r("2e91")),s=r("b8f9"),d=r("31ae"),l={name:"CommissionEdit",data:function(){return{id:null,formModel:{hide:[],readonly:[]}}},created:function(){if(this.id=this.$GetParamsId(this),!this.id)return this.$Notice.error({title:this.$t("dt.toast.tips"),desc:this.$t("dt.toast.notExistent")}),this.$router.push({name:"admin.CommissionList"}),!1},mounted:function(){},components:{FormModel:d["a"]},watch:{},methods:{handleFormDataSubmit:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},s["a"].isObject(a)&&s["a"].isObject(a.data)&&!s["a"].isEmpty(a.data)){r.next=4;break}return t.$Message.error(t.$t("dt.base.invalidData")),r.abrupt("return");case 4:o=Object(n["a"])({},a.data),i={id:o.id,data:Object(n["a"])({},o)},t.$Http.Post({mutation:t.$Model.DividendOrderEdit,variables:i}).then((function(){t.$Message.success(t.$t("dt.toast.saveOk")),t.handleRouteGoBack("admin.CommissionList")}));case 7:case"end":return r.stop()}}),r)})))()}}},m=l,u=r("c701"),c=Object(u["a"])(m,a,o,!1,null,"62cfd1e1",null);t["default"]=c.exports},f1ec:function(e,t,r){"use strict";r("04d5")}}]);