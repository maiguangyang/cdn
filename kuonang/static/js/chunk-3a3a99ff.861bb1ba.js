(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a3a99ff"],{"0969":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ProductAttr-edit-page"},[a("div",{staticClass:"wrapper"},[a("div",{staticClass:"controller"},[a("form-model",{attrs:{formModel:t.formModel,tabName:[t.$t("dt.form.ProductAttrEdit")],btnTitle:t.$t("dt.base.save")},on:{formDataSubmit:t.handleFormDataSubmit}})],1)])])},o=[],n=a("d211"),i=(a("6a61"),a("2e91")),s=a("b8f9"),l=a("253b"),d={name:"ProductAttrEdit",data:function(){return{id:null,formModel:{hide:[],readonly:[]}}},created:function(){if(this.id=this.$GetParamsId(this),!this.id)return this.$Notice.error({title:this.$t("dt.toast.tips"),desc:this.$t("dt.toast.notExistent")}),this.$router.push({name:"admin.ProductAttrList"}),!1},mounted:function(){},components:{FormModel:l["a"]},watch:{},methods:{handleFormDataSubmit:function(){var t=arguments,e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:{},s["a"].isObject(r)&&s["a"].isObject(r.data)&&!s["a"].isEmpty(r.data)){a.next=4;break}return e.$Message.error(e.$t("dt.base.invalidData")),a.abrupt("return");case 4:o=Object(n["a"])({},r.data),i={id:o.id,data:Object(n["a"])({},o)},e.$Http.Post({mutation:e.$Model.ProductAttrEdit,variables:i}).then((function(){e.$Message.success(e.$t("dt.toast.saveOk")),e.handleRouteGoBack("admin.ProductAttrList")}));case 7:case"end":return a.stop()}}),a)})))()}}},m=d,c=a("c701"),u=Object(c["a"])(m,r,o,!1,null,"471251ee",null);e["default"]=u.exports},"253b":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-content-layer"},[a("Tabs",{staticClass:"tabs",attrs:{type:"card"}},[a("TabPane",{attrs:{label:t.tabName[0]}},[a("Form",{ref:"form",staticClass:"form-page",attrs:{"label-position":"right","label-width":100,model:t.formData,rules:t.ruleInline}},[a("Col",{directives:[{name:"show",rawName:"v-show",value:!t.$FormCheck("name",t.formModel.hide),expression:"!$FormCheck('name', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:t.$t("dt.form.AttrName"),prop:"name"}},[a("Input",{attrs:{readonly:t.$FormCheck("name",t.formModel.readonly),clearable:!t.$FormCheck("name",t.formModel.readonly),placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.ProductAttrName")})},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!t.$FormCheck("tye",t.formModel.hide),expression:"!$FormCheck('tye', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:t.$t("dt.form.AttrCategory"),prop:"tye"}},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":t.handleAttrTypeChange},model:{value:t.formData.tye,callback:function(e){t.$set(t.formData,"tye",e)},expression:"formData.tye"}},t._l(t.$options.filters.productAttrType([]),(function(e,r){return a("Radio",{key:r,attrs:{clearable:!t.$FormCheck("tye",t.formModel.readonly),disabled:t.$FormCheck("tye",t.formModel.readonly),label:e.value}},[t._v(" "+t._s(e.label)+" ")])})),1)],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!t.$FormCheck("remark",t.formModel.hide),expression:"!$FormCheck('remark', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:t.$t("dt.base.remark"),prop:"remark"}},[a("Input",{attrs:{readonly:t.$FormCheck("remark",t.formModel.readonly),clearable:!t.$FormCheck("remark",t.formModel.readonly),maxlength:"255","show-word-limit":"",type:"textarea",rows:4,placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.base.remark")})},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1)],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!t.$FormCheck("weight",t.formModel.hide),expression:"!$FormCheck('weight', formModel.hide)"}],staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:t.$t("dt.form.weight"),prop:"weight"}},[a("Input",{attrs:{readonly:t.$FormCheck("weight",t.formModel.readonly),clearable:!t.$FormCheck("weight",t.formModel.readonly),placeholder:t.$t("dt.base.pleaseInput",{label:t.$t("dt.form.weight")})},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",t._n(e))},expression:"formData.weight"}})],1)],1),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",{attrs:{label:t.$t("dt.form.status")}},[a("i-switch",{attrs:{disabled:t.$FormCheck("state",t.formModel.readonly),size:"large"},model:{value:t.formData.state,callback:function(e){t.$set(t.formData,"state",e)},expression:"formData.state"}},t._l(t.$options.filters.state([]),(function(e,r){return a("span",{key:r,attrs:{slot:1===1*e.value?"open":"close"},slot:1===1*e.value?"open":"close"},[t._v(t._s(e.label))])})),0)],1)],1),1!==t.formData.tye?a("Col",{staticClass:"input-item",attrs:{xs:24,sm:24,md:24,lg:24,xl:16,xxl:10}},[a("FormItem",{attrs:{label:t.$t("dt.form.AttrType")}},[a("Table",{attrs:{columns:t.columns,data:t.formData.attrs,draggable:!0},on:{"on-drag-drop":t.handleTableOnDragDrop},scopedSlots:t._u([{key:"value",fn:function(e){var r=e.row,o=e.index,n=e.column;return[a("Input",{attrs:{type:"text",readonly:t.$FormCheck(n.slot,t.formModel.readonly),clearable:!t.$FormCheck(n.slot,t.formModel.readonly)},on:{input:function(e){return t.handleValueChange(r,o,n.slot)}},model:{value:r.value,callback:function(e){t.$set(r,"value",e)},expression:"row.value"}})]}},{key:"filter",fn:function(e){var r=e.row,o=e.index,n=e.column;return[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":function(e){return t.handleValueChange(r,o,n.slot)}},model:{value:r.filter,callback:function(e){t.$set(r,"filter",e)},expression:"row.filter"}},t._l(t.$options.filters.noOrYes([]),(function(e,r){return a("Radio",{key:r,attrs:{readonly:t.$FormCheck(n.slot,t.formModel.readonly)||t.isReadonly,disabled:t.$FormCheck(n.slot,t.formModel.readonly)||t.isReadonly,clearable:!t.$FormCheck(n.slot,t.formModel.readonly)||!t.isReadonly,label:e.value}},[t._v(t._s(e.label)+" ")])})),1)]}},{key:"action",fn:function(e){var r=e.index;return[t.formData.attrs.length>1?a("Button",{staticStyle:{"margin-right":"5px"},attrs:{size:"small",type:"error",disabled:t.isReadonly},on:{click:function(e){return t.handleAttrValueRemove(r)}}},[t._v(" "+t._s(t.$t("dt.form.delete"))+" ")]):t._e(),t.formData.attrs.length-1===r?a("Button",{attrs:{size:"small",type:"primary",disabled:t.isReadonly},on:{click:function(e){return t.handleAttrValueAdd()}}},[t._v(" "+t._s(t.$t("dt.form.add"))+" ")]):t._e()]}}],null,!1,1050306360)})],1)],1):t._e(),a("Col",{staticClass:"input-item",attrs:{xs:24,sm:16,md:16,lg:12,xl:8,xxl:6}},[a("FormItem",[!t.isReadonly&&t.$isHasMenuAuth("admin.ProductAttrAdd")||!t.isReadonly&&t.$isHasMenuAuth("admin.ProductAttrEdit")?a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSumbitCheck}},[t._v(" "+t._s(t.btnTitle)+" ")]):t.$isHasMenuAuth("admin.ProductAttrEdit")?a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.handleCheckHabitType({name:"admin.ProductAttrEdit",params:{id:t.id}})}}},[t._v(" "+t._s(t.$t("dt.form.edit"))+" ")]):t._e(),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleRouteGoBack("admin.ProductAttrList")}}},[t._v(t._s(t.$t("dt.base.back")))])],1)],1)],1)],1)],1)],1)},o=[],n=(a("2d38"),a("2c78"),a("02bf"),a("90d4"),a("4c09")),i=a("d211"),s=a("b8f9"),l=a("4ec25"),d={name:"ProductAttrModel",mixins:[l["a"]],data:function(){return{formData:{tye:1,attrs:[{value:null,filter:2}]},columns:[{title:this.$t("dt.form.AttrType"),align:"center",slot:"value"},{title:this.$t("dt.form.screen"),align:"center",width:150,slot:"filter"},{title:this.$t("dt.form.action"),width:150,slot:"action"}],ruleInline:{name:[{required:!0,message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.form.ProductAttrName")}),trigger:"blur"}],tye:[{required:!0,type:"number",message:this.$t("dt.base.pleaseInput",{label:this.$t("dt.base.Type")}),trigger:"blur"}],weight:[{required:!0,type:"number",message:this.$t("dt.form.weightPlaceholder"),trigger:"blur"},{validator:this.$Validator("number",this.$t("dt.form.weightPlaceholder")),trigger:"blur"}]}}},created:function(){s["a"].isEmpty(this.id)||this.handleDetail()},mounted:function(){},components:{},watch:{},methods:{handleDetail:function(){var t=this;this.$Http.Post({mutation:this.$Model.ProductAttrDetail,variables:{id:this.id},fields:["id","name","remark","tye","weight","state","attrs.id","attrs.value","attrs.filter"]},(function(){t.$router.push({name:"admin.ProductAttrList"})})).then((function(e){var a=e.data;a.state=1===a.state||!0===a.state,t.formData=Object(i["a"])(Object(i["a"])({},t.formData),a)}))},handleValueChange:function(t,e,a){this.formData.attrs[e][a]=t[a]},handleAttrValueRemove:function(t){this.formData.attrs.splice(t,1)},handleAttrValueAdd:function(){var t=this.handleCheckEmptyAttrValue();!0!==t?s["a"].isRepeat(this.formData.attrs.map((function(t){return t.value})))?this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.AttrType")+this.$t("dt.base.isBeRepeat")}):this.formData.attrs.push({value:null,filter:2}):this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.AttrType")+this.$t("dt.api.notEmpty")})},handleCheckEmptyAttrValue:function(){var t=this.formData.attrs;return t.filter((function(t){return s["a"].isEmpty(t.value)})).length>0},handleAttrTypeChange:function(t){1!==t&&this.formData.attrs.length<=0&&(this.formData.attrs=[{value:null,filter:2}])},handleTableOnDragDrop:function(t,e){var a;(a=this.formData.attrs).splice.apply(a,[e,0].concat(Object(n["a"])(this.formData.attrs.splice(t,1))))},handleSumbitCheck:function(){var t=Object(i["a"])({},this.formData);if(1!==t.tye){var e=this.handleCheckEmptyAttrValue();if(!0===e)return void this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.AttrType")+this.$t("dt.api.notEmpty")});if(s["a"].isRepeat(t.attrs.map((function(t){return t.value}))))return void this.$Notice.warning({title:this.$t("dt.toast.tips"),desc:this.$t("dt.form.AttrType")+this.$t("dt.base.isBeRepeat")});s["a"].each(t.attrs,(function(t,e){t.weight=e+1}))}else delete t.attrs;this.handleSumbit(t)}}},m=d,c=(a("c602"),a("c701")),u=Object(c["a"])(m,r,o,!1,null,"6cb92980",null);e["a"]=u.exports},"4ec25":function(t,e,a){"use strict";a("6a61");var r=a("2e91"),o=a("d211"),n=a("5880"),i=a("b8f9"),s={data:function(){return{id:null,isReadonly:!1,formData:{branchId:this.$UserInfo.bid,state:!0,weight:1}}},props:{formData_bak:{type:Object,default:function(){return{}}},formModel:{type:Object,default:function(){return{}}},btnTitle:{type:String,default:""},tabName:{type:Array,default:function(){return[null]}}},created:function(){this.id=this.$GetParamsId(this),this.$FormCheck("*",this.formModel.readonly)&&(this.isReadonly=!0,this.ruleInline={})},computed:Object(o["a"])({},Object(n["mapState"])("base",{loading:function(t){return t.loading},isMethodList:function(t){return t.isMethodList}})),methods:{handleEmitData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData;this.$store.commit("popupModel/pageModal",{pageModal:!1}),this.$emit("formDataSubmit",{data:t})},handleFilterBranchChange:function(t){i["a"].isEmpty(t)||(this.formData.branchId=t)},handleSumbit:function(){var t=arguments,e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,n,s,l,d,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=t.length>0&&void 0!==t[0]?t[0]:e.formData,n=t.length>1&&void 0!==t[1]?t[1]:"form",o.state=!0===o.state||1*o.state===1?1:2,s=!0,l=!1,!i["a"].isString(n)){a.next=16;break}if(e.$refs[n]){a.next=11;break}s=!1,l=!0,a.next=14;break;case 11:return a.next=13,e.$refs[n].validate((function(t){return t}));case 13:l=a.sent;case 14:a.next=22;break;case 16:if(!i["a"].isArray(n)){a.next=22;break}return d=!0,i["a"].each(n,function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs[a]?e.$refs[a].validate((function(t){!1===t&&!0===d&&(d=!1)})):(s=!1,d=!0);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a.next=21,d;case 21:l=a.sent;case 22:if(!1!==s||!0!==l){a.next=25;break}return e.handleEmitData(o),a.abrupt("return");case 25:if(!1!==l){a.next=28;break}return e.$Message.error(e.$t("dt.form.checkFormComplete")),a.abrupt("return");case 28:m=e.$store.state.popupModel.pageModal,!0===m&&e.$store.commit("popupModel/loadData",{loadData:!0}),e.handleEmitData(o);case 31:case"end":return a.stop()}}),a)})))()}}};e["a"]=s},a704:function(t,e,a){},c602:function(t,e,a){"use strict";a("a704")}}]);